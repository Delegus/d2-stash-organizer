import{I as e,A as t,W as n,M as i,R as o,U as r,S as s,a,b as l,c,d,P as u,G as h,e as f,C as p,f as m,g}from"./game-data-d5221508.js";var v,b,w,y,_,k,x,S={},O=[],j=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function I(e,t){for(var n in t)e[n]=t[n];return e}function A(e){var t=e.parentNode;t&&t.removeChild(e)}function q(e,t,n,i,o){var r={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:o??++w};return null!=b.vnode&&b.vnode(r),r}function C(e){return e.children}function E(e,t){this.props=e,this.context=t}function M(e,t){if(null==t)return e.__?M(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?M(e):null}function $(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return $(e)}}function U(e){(!e.__d&&(e.__d=!0)&&y.push(e)&&!P.__r++||k!==b.debounceRendering)&&((k=b.debounceRendering)||_)(P)}function P(){for(var e;P.__r=y.length;)e=y.sort((function(e,t){return e.__v.__b-t.__v.__b})),y=[],e.some((function(e){var t,n,i,o,r,s;e.__d&&(r=(o=(t=e).__v).__e,(s=t.__P)&&(n=[],(i=I({},o)).__v=o.__v+1,H(s,o,i,t.__n,void 0!==s.ownerSVGElement,null!=o.__h?[r]:null,n,r??M(o),o.__h),R(n,o),o.__e!=r&&$(o)))}))}function N(e,t,n,i,o,r,s,a,l,c){var d,u,h,f,p,m,g,v=i&&i.__k||O,b=v.length;for(n.__k=[],d=0;d<t.length;d++)if(null!=(f=n.__k[d]=null==(f=t[d])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?q(null,f,null,null,f):Array.isArray(f)?q(C,{children:f},null,null,null):f.__b>0?q(f.type,f.props,f.key,null,f.__v):f)){if(f.__=n,f.__b=n.__b+1,null===(h=v[d])||h&&f.key==h.key&&f.type===h.type)v[d]=void 0;else for(u=0;u<b;u++){if((h=v[u])&&f.key==h.key&&f.type===h.type){v[u]=void 0;break}h=null}H(e,f,h=h||S,o,r,s,a,l,c),p=f.__e,(u=f.ref)&&h.ref!=u&&(g||(g=[]),h.ref&&g.push(h.ref,null,f),g.push(u,f.__c||p,f)),null!=p?(null==m&&(m=p),"function"==typeof f.type&&null!=f.__k&&f.__k===h.__k?f.__d=l=T(f,l,e):l=L(e,f,h,v,p,l),c||"option"!==n.type?"function"==typeof n.type&&(n.__d=l):e.value=""):l&&h.__e==l&&l.parentNode!=e&&(l=M(h))}for(n.__e=m,d=b;d--;)null!=v[d]&&("function"==typeof n.type&&null!=v[d].__e&&v[d].__e==n.__d&&(n.__d=M(i,d+1)),V(v[d],v[d]));if(g)for(d=0;d<g.length;d++)Y(g[d],g[++d],g[++d])}function T(e,t,n){var i,o;for(i=0;i<e.__k.length;i++)(o=e.__k[i])&&(o.__=e,t="function"==typeof o.type?T(o,t,n):L(n,o,o,e.__k,o.__e,t));return t}function L(e,t,n,i,o,r){var s,a,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||o!=r||null==o.parentNode)e:if(null==r||r.parentNode!==e)e.appendChild(o),s=null;else{for(a=r,l=0;(a=a.nextSibling)&&l<i.length;l+=2)if(a==o)break e;e.insertBefore(o,r),s=r}return void 0!==s?s:o.nextSibling}function B(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||j.test(t)?n:n+"px"}function D(e,t,n,i,o){var r;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||B(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||B(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])r=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i||e.addEventListener(t,r?z:F,r):e.removeEventListener(t,r?z:F,r);else if("dangerouslySetInnerHTML"!==t){if(o)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=n??"";break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function F(e){this.l[e.type+!1](b.event?b.event(e):e)}function z(e){this.l[e.type+!0](b.event?b.event(e):e)}function H(e,t,n,i,o,r,s,a,l){var c,d,u,h,f,p,m,g,v,w,y,_=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(l=n.__h,a=t.__e=n.__e,t.__h=null,r=[a]),(c=b.__b)&&c(t);try{e:if("function"==typeof _){if(g=t.props,v=(c=_.contextType)&&i[c.__c],w=c?v?v.props.value:c.__:i,n.__c?m=(d=t.__c=n.__c).__=d.__E:("prototype"in _&&_.prototype.render?t.__c=d=new _(g,w):(t.__c=d=new E(g,w),d.constructor=_,d.render=G),v&&v.sub(d),d.props=g,d.state||(d.state={}),d.context=w,d.__n=i,u=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=_.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=I({},d.__s)),I(d.__s,_.getDerivedStateFromProps(g,d.__s))),h=d.props,f=d.state,u)null==_.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==_.getDerivedStateFromProps&&g!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(g,w),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(g,d.__s,w)||t.__v===n.__v){d.props=g,d.state=d.__s,t.__v!==n.__v&&(d.__d=!1),d.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),d.__h.length&&s.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(g,d.__s,w),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(h,f,p)}))}d.context=w,d.props=g,d.state=d.__s,(c=b.__r)&&c(t),d.__d=!1,d.__v=t,d.__P=e,c=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(i=I(I({},i),d.getChildContext())),u||null==d.getSnapshotBeforeUpdate||(p=d.getSnapshotBeforeUpdate(h,f)),y=null!=c&&c.type===C&&null==c.key?c.props.children:c,N(e,Array.isArray(y)?y:[y],t,n,i,o,r,s,a,l),d.base=t.__e,t.__h=null,d.__h.length&&s.push(d),m&&(d.__E=d.__=null),d.__e=!1}else null==r&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=W(n.__e,t,n,i,o,r,s,l);(c=b.diffed)&&c(t)}catch(e){t.__v=null,(l||null!=r)&&(t.__e=a,t.__h=!!l,r[r.indexOf(a)]=null),b.__e(e,t,n)}}function R(e,t){b.__c&&b.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){b.__e(e,t.__v)}}))}function W(e,t,n,i,o,r,s,a){var l,c,d,u=n.props,h=t.props,f=t.type,p=0;if("svg"===f&&(o=!0),null!=r)for(;p<r.length;p++)if((l=r[p])&&(l===e||(f?l.localName==f:3==l.nodeType))){e=l,r[p]=null;break}if(null==e){if(null===f)return document.createTextNode(h);e=o?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),r=null,a=!1}if(null===f)u===h||a&&e.data===h||(e.data=h);else{if(r=r&&v.call(e.childNodes),c=(u=n.props||S).dangerouslySetInnerHTML,d=h.dangerouslySetInnerHTML,!a){if(null!=r)for(u={},p=0;p<e.attributes.length;p++)u[e.attributes[p].name]=e.attributes[p].value;(d||c)&&(d&&(c&&d.__html==c.__html||d.__html===e.innerHTML)||(e.innerHTML=d&&d.__html||""))}if(function(e,t,n,i,o){var r;for(r in n)"children"===r||"key"===r||r in t||D(e,r,null,n[r],i);for(r in t)o&&"function"!=typeof t[r]||"children"===r||"key"===r||"value"===r||"checked"===r||n[r]===t[r]||D(e,r,t[r],n[r],i)}(e,h,u,o,a),d)t.__k=[];else if(p=t.props.children,N(e,Array.isArray(p)?p:[p],t,n,i,o&&"foreignObject"!==f,r,s,r?r[0]:n.__k&&M(n,0),a),null!=r)for(p=r.length;p--;)null!=r[p]&&A(r[p]);a||("value"in h&&void 0!==(p=h.value)&&(p!==e.value||"progress"===f&&!p)&&D(e,"value",p,u.value,!1),"checked"in h&&void 0!==(p=h.checked)&&p!==e.checked&&D(e,"checked",p,u.checked,!1))}return e}function Y(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){b.__e(e,n)}}function V(e,t,n){var i,o;if(b.unmount&&b.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||Y(i,null,t)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){b.__e(e,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&V(i[o],t,"function"!=typeof e.type);n||null==e.__e||A(e.__e),e.__e=e.__d=void 0}function G(e,t,n){return this.constructor(e,n)}function Q(e,t){var n={__c:t="__cC"+x++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,i;return this.getChildContext||(n=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(U)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}v=O.slice,b={__e:function(e,t){for(var n,i,o;t=t.__;)if((n=t.__c)&&!n.__)try{if((i=n.constructor)&&null!=i.getDerivedStateFromError&&(n.setState(i.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),o=n.__d),o)return n.__E=n}catch(t){e=t}throw e}},w=0,E.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=I({},this.state),"function"==typeof e&&(e=e(I({},n),this.props)),e&&I(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),U(this))},E.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),U(this))},E.prototype.render=C,y=[],_="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,P.__r=0,x=0;var J=0;function X(e,t,n,i,o){var r,s,a={};for(s in t)"ref"==s?r=t[s]:a[s]=t[s];var l={type:e,props:a,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--J,__source:i,__self:o};if("function"==typeof e&&(r=e.defaultProps))for(s in r)void 0===a[s]&&(a[s]=r[s]);return b.vnode&&b.vnode(l),l}function Z(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}function K(){return X("a",Object.assign({style:"float: right",href:"https://github.com/kpa23/d2-stash-organizer","aria-label":"Source code on GitHub",target:"_blank"},{children:X("svg",Object.assign({style:"fill: white",height:"32",viewBox:"0 0 16 16",version:"1.1",width:"32","aria-hidden":"true"},{children:X("path",{"fill-rule":"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"},void 0)}),void 0)}),void 0)}Z(".accessible-font{font-family:Verdana,Arial,Helvetica,sans-serif;font-weight:400;letter-spacing:normal}h1{font-family:AvQuest;font-weight:700;letter-spacing:1px;margin-top:0}.hidden{display:none}.sr-only{height:1px;left:-1px;overflow:hidden;position:fixed;top:-1px;width:1px}a,a:visited{color:#c7b377}.button,a,a:visited{text-decoration:none}.button{appearance:none;background:transparent;border:2px solid;border-color:initial;border-radius:0;box-shadow:none;color:#fff;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:1px;margin:0;padding:.4em .8em;text-align:initial}li input[type=radio]{margin-bottom:.6em;vertical-align:-12%}.magic{color:#6969ff}.rare{color:#ffff64}.unique{color:#c7b377}.set{color:#0f0}.crafted{color:#ffa800}.sidenote,.socketed{color:#787878}.danger{color:#ff6f6f}");var ee,te,ne,ie=0,oe=[],re=b.__b,se=b.__r,ae=b.diffed,le=b.__c,ce=b.unmount;function de(e,t){b.__h&&b.__h(te,e,ie||t),ie=0;var n=te.__H||(te.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function ue(e){return ie=1,function(e,t,n){var i=de(ee++,2);return i.t=e,i.__c||(i.__=[n?n(t):ke(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}],i.__c=te),i.__}(ke,e)}function he(e,t){var n=de(ee++,3);!b.__s&&_e(n.__H,t)&&(n.__=e,n.__H=t,te.__H.__h.push(n))}function fe(e){return ie=5,pe((function(){return{current:e}}),[])}function pe(e,t){var n=de(ee++,7);return _e(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function me(e,t){return ie=8,pe((function(){return e}),t)}function ge(e){var t=te.context[e.__c],n=de(ee++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(te)),t.props.value):e.__}function ve(){oe.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(we),e.__H.__h.forEach(ye),e.__H.__h=[]}catch(t){e.__H.__h=[],b.__e(t,e.__v)}})),oe=[]}b.__b=function(e){te=null,re&&re(e)},b.__r=function(e){se&&se(e),ee=0;var t=(te=e.__c).__H;t&&(t.__h.forEach(we),t.__h.forEach(ye),t.__h=[])},b.diffed=function(e){ae&&ae(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==oe.push(t)&&ne===b.requestAnimationFrame||((ne=b.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(i),be&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);be&&(t=requestAnimationFrame(n))})(ve)),te=void 0},b.__c=function(e,t){t.some((function(e){try{e.__h.forEach(we),e.__h=e.__h.filter((function(e){return!e.__||ye(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],b.__e(n,e.__v)}})),le&&le(e,t)},b.unmount=function(e){ce&&ce(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(we)}catch(e){b.__e(e,t.__v)}};var be="function"==typeof requestAnimationFrame;function we(e){var t=te;"function"==typeof e.__c&&e.__c(),te=t}function ye(e){var t=te;e.__c=e.__(),te=t}function _e(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function ke(e,t){return"function"==typeof t?t(e):t}class xe{constructor(e){this.raw=e,this.peek=!1,this.nextIndex=0,this.dataView=new DataView(this.raw.buffer)}moveTo(e){this.peek||(this.nextIndex=e)}get done(){return this.nextIndex>=this.raw.length}read(e,t=this.nextIndex){return this.moveTo(t+e),this.raw.slice(t,t+e)}readString(e,t=this.nextIndex){return String.fromCharCode(...this.read(e,t))}readNullTerminatedString(e=this.nextIndex){const t=[];for(;this.raw[e]>0;)t.push(this.raw[e]),e++;return e++,this.moveTo(e),String.fromCharCode(...t)}readRemaining(e=this.nextIndex){return this.moveTo(this.raw.length),this.raw.slice(e,this.raw.length)}readInt8(e=this.nextIndex){return this.moveTo(e+1),this.dataView.getUint8(e)}readInt16LE(e=this.nextIndex){return this.moveTo(e+2),this.dataView.getUint16(e,!0)}readInt32LE(e=this.nextIndex){return this.moveTo(e+4),this.dataView.getUint32(e,!0)}}function Se(e){let t="",n=0;const i={skip:e=>(n+=e,!1),read(i,o=n){const r=o+i-t.length;return r>0&&(t+=e.read(Math.ceil(r/8)).reduce(((e,t)=>e+je(t,8)),"")),n=o+i,t.slice(o,o+i)},readInt:(e,t=n)=>Oe(i.read(e,t)),readBool:(e=n)=>"1"===i.read(1,e),done:()=>t.slice(0,n)};return i}function Oe(e){return parseInt(e.split("").reverse().join(""),2)}function je(e,t){return e.toString(2).padStart(t,"0").split("").reverse().join("")}function Ie(e){return e.split("").map((e=>je(e.charCodeAt(0),8))).join("")}function Ae(e){const t=[];for(let n=0;n<e.length/8;n++)t.push(Oe(e.slice(8*n,8*(n+1))));return t}function qe(e){var o;const r=t[e.code]||n[e.code]||i[e.code];if(!r)throw new Error(`Could not find base ${e.code} for ${null!==(o=e.name)&&void 0!==o?o:"unknown item"}`);return r}const Ce=[[[[["w","u"],[["8",["y",["5",["j",[]]]]],"h"]],["s",[["2","n"],"x"]]],[[["c",["k","f"]],"b"],[["t","m"],["9","7"]]]],[" ",[[[["e","d"],"p"],["g",[[["z","q"],"3"],["v","6"]]]],[["r","l"],["a",[["1",["4","0"]],["i","o"]]]]]]],Ee=new Map;function Me(e){return e.split("").map((t=>{const n=Ee.get(t);if(void 0===n)throw new Error(`Failed to huffman encode ${e}.`);return n})).join("")}!function e(t,n=""){t&&(Array.isArray(t)?(e(t[0],n+"0"),e(t[1],n+"1")):Ee.set(t,n))}(Ce);const $e=[[{name:"Rings",shortName:"rings",types:["ring"],layout:"single-line"},{name:"Amulets",shortName:"amulets",types:["amul"]},{name:"Charms",shortName:"charms",types:["scha","mcha","lcha"],layout:"single-column"},{name:"Jewels",shortName:"jewels",types:["jewl"],layout:"single-line"}],[{name:"Armor",shortName:"armor",types:["tors"]},{name:"Helms",shortName:"helms",types:["helm","circ"]},{name:"Gloves",shortName:"gloves",types:["glov"]},{name:"Belts",shortName:"belts",types:["belt"],layout:"tier-columns"},{name:"Boots",shortName:"boots",types:["boot"]},{name:"Shields",shortName:"shields",types:["shie"]}],[{name:"One-hand axes",shortName:"axes",types:["axe"],twoHanded:!1},{name:"Two-hand axes",shortName:"axes",types:["axe"],twoHanded:!0},{name:"Bows",shortName:"bows",types:["bow"]},{name:"Crossbows",shortName:"crossbows",types:["xbow"]},{name:"Daggers",shortName:"daggers",types:["knif"]},{name:"One-hand maces",shortName:"maces",types:["club","mace","hamm","scep"],twoHanded:!1},{name:"Two-hand maces",shortName:"maces",types:["club","mace","hamm","scep"],twoHanded:!0},{name:"Polearms",shortName:"polearms",types:["pole"]},{name:"Spears",shortName:"spears",types:["spea"]},{name:"Staves",shortName:"staves",types:["staf"]},{name:"One-hand swords",shortName:"swords",types:["swor"],twoHanded:!1},{name:"Two-hand swords",shortName:"swords",types:["swor"],twoHanded:!0},{name:"Throwing",shortName:"throwing",types:["taxe","tkni","jave"]},{name:"Wands",shortName:"wands",types:["wand"]}],[{name:"Amazon",shortName:"Amazon",types:["ajav","abow","aspe"]},{name:"Assassin",shortName:"Assassin",types:["h2h","h2h2"]},{name:"Barbarian",shortName:"Barbarian",types:["phlm"]},{name:"Druid",shortName:"Druid",types:["pelt"]},{name:"Necromancer",shortName:"Necro",types:["head"]},{name:"Paladin",shortName:"Paladin",types:["ashd"]},{name:"Sorceress",shortName:"Sorceress",types:["orb"]}]],Ue=[],Pe=new Map;for(const e of $e)for(const t of e){Ue.push(...t.types);for(const e of t.types)void 0===t.twoHanded?Pe.set(e,t):Pe.set(`${e}-${Number(t.twoHanded)}`,t)}const Ne=$e.flat().reduce(((e,t)=>{const n=t.shortName,i=t.shortName.charAt(0).toUpperCase()+t.shortName.slice(1);return e[n]=i,e}),{});function Te(e,t){const{read:n,readBool:i,readInt:o,skip:r}=e,s={raw:"",owner:t,identified:r(4)||i(),socketed:r(6)||i(),simple:r(9)||i(),ethereal:i(),personalized:r(1)||i(),runeword:r(1)||i(),version:r(5)||(t.version>=97?n(3):o(10).toString()),location:o(3),equippedInSlot:o(4),column:o(4),row:o(4),stored:o(3),code:"",search:"",isStack:!1};t.version>=97?s.code=function(e,t){let n="";for(let i=0;i<t;i++){let t=Ce;for(;Array.isArray(t);)t=t[Number(e.read(1))];n+=t}return n}(e,4).trim():s.code=String.fromCharCode(o(8),o(8),o(8),o(8)).trim();const a=qe(s);return Pe.forEach((e=>{e.types.flat().includes(a.type)&&(s.itemType=e.shortName)})),void 0===a?(console.error("base  === undefined"),n(2),s):("ques"===a.type&&a.trackQuestDifficulty&&n(2),["orbx","gemx","runx","bowq","xboq","key","book"].includes(a.type)&&(s.isStack=!0,s.name=a.name),s.nbFilledSockets=o(s.simple?1:3),s.socketed&&s.nbFilledSockets>0&&(s.filledSockets=[]),s.simple&&(s.name=a.name),s)}function Le({read:e,readInt:o},r){const s=t[r.code],a=n[r.code],l=i[r.code];if(s&&(r.defense=o(11)-10),s||a){const t=o(8);t&&(r.durability=[o(8),t],e(1))}((null==s?void 0:s.stackable)||(null==a?void 0:a.stackable)||(null==l?void 0:l.stackable))&&(r.quantity=o(9)),r.socketed&&(r.sockets=o(4))}const Be=["item_armor_percent","armorclass","item_armor_perlevel","item_armorpercent_perlevel"];function De({readInt:t},n){const i=[];let o=t(9);for(;511!=o;){let r=e[o];if(null!=r&&null!=r||(o=t(9),r=e[o]),o>403&&(o=t(9),r=e[o]),null==r)return i;let s={id:o,stat:r.stat,priority:r.descPriority};if(3===r.encode)s={...s,level:t(6)-r.bias,spell:t(10)-r.bias,charges:t(8)-r.bias,maxCharges:t(8)-r.bias};else if(2===r.encode)s={...s,level:t(6)-r.bias,spell:t(10)-r.bias,chance:t(r.size)-r.bias};else{let e;r.paramSize&&(e=t(r.paramSize)-r.bias),s={...s,value:t(r.size)-r.bias,param:e}}i.push(s),Be.includes(s.stat)&&(n.enhancedDefense=!0),"maxdurability"===r.stat&&(n.extraDurability=s.value),o=r.followedBy?r.followedBy:t(9)}return i}function Fe(e,t){const n=Se(e);if(t.version<=96){const e=String.fromCharCode(n.readInt(8),n.readInt(8));if("JM"!==e)throw new Error(`Unexpected header ${e} for an item`)}const c=Te(n,t);if(c.isStack&&!c.simple&&(Le(n,c),n.readInt(64)),!c.isStack&&!c.simple)try{!function({read:e,readBool:t,readInt:n},c){var d,u;switch(c.id=n(32),c.level=n(7),c.quality=n(4),t()&&(c.picture=n(3)),t()&&(c.classSpecificAffix=n(11)),c.quality){case 2:c.name=qe(c).name;break;case 1:c.qualityModifier=n(3),c.name=`Low Quality ${qe(c).name}`;break;case 3:c.qualityModifier=n(3),c.name=`Superior ${qe(c).name}`;break;case 4:c.prefixes=[n(11)],c.suffixes=[n(11)],c.name=qe(c).name,c.prefixes[0]&&null!=a[c.prefixes[0]]&&(c.name=`${a[c.prefixes[0]].name} ${c.name}`),c.suffixes[0]&&null!=l[c.suffixes[0]]&&(c.name=`${c.name} ${l[c.suffixes[0]].name}`);break;case 5:c.unique=n(12),c.name=s[c.unique].name;break;case 7:c.unique=n(12),c.name=r[c.unique].name;break;case 6:case 8:c.name=`${o[n(8)]} ${o[n(8)]}`,c.prefixes=[],c.suffixes=[];for(let e=0;e<6;e++)t()&&(null===(d=c[e%2?"suffixes":"prefixes"])||void 0===d||d.push(n(11)))}if(c.runeword&&(c.runewordId=n(12)-27,2691===c.runewordId&&(c.runewordId=21),e(4)),c.personalized){let e,t="";for(;0!==(e=n(8));)t+=String.fromCharCode(e);c.name=`${t}'s ${c.name}`}"book"===(null===(u=i[c.code])||void 0===u?void 0:u.type)&&e(5),e(1)}(n,c),Le(n,c),function(e,t){t.modifiers=[];const n=5===t.quality?e.read(5):void 0;if(t.runeword&&t.modifiers.push(...De(e,t)),t.modifiers.push(...De(e,t)),n){t.setItemModifiers=[];for(let i=0;i<n.length;i++)"1"===n[i]?t.setItemModifiers.push(De(e,t)):t.setItemModifiers.push([])}}(n,c)}catch(e){"string"==typeof e?console.error(e.toUpperCase()):e instanceof Error&&(console.error(e.stack),console.error(e.message)),console.log("@@@ couldn't parse item: ",c)}return c.raw=n.done(),c}function ze(e,t){var n,i;const o=e.readString(2);if("JM"!==o)throw new Error(`Unexpected header ${o} for an item list`);let r=e.readInt16LE();console.warn("Total Items:%s",r);const s=[];let a="";for(;r>0;){const o=Fe(e,t);if(null!=o){if(6===o.location){const e=s[s.length-1];if(!e.filledSockets)throw new Error("Trying to socket a non-socketed item");if(o.socketedIn=e,a+=o.code,e.filledSockets.push(o),e.filledSockets.length==e.sockets){const t=null===(n=c.find((e=>e.word==a)))||void 0===n?void 0:n.name;e.name=t??e.name,a=""}}else s.push(o),r+=null!==(i=o.nbFilledSockets)&&void 0!==i?i:0;r--}else r--}return s}function He({prop:e,min:t,max:n,param:i},o,r){var s,a;const{stats:l}=u[e];for(const{stat:c,type:u}of l)if("other"===u||"param"===u&&!i){let l=e=>e.stat===c;if("skill"===e)l=e=>"param"in e&&e.param===i&&e.stat===c;else if("skilltab"===e){const e=null===(s=d[Number(i)])||void 0===s?void 0:s.id;l=t=>"param"in t&&t.param===e&&t.stat===c}const u=null==o?void 0:o.find(l);if(("dmg-min"===e||"dmg-max"===e)&&void 0===u)continue;u&&(u.range=[t,n]),r(null!==(a=null==u?void 0:u.value)&&void 0!==a?a:0,t,n)}else if("all"===u){const e=null==o?void 0:o.find((e=>e.stat===c));e&&(e.range=[t,n])}}class Re extends Error{constructor(e,t){let n=e.name;if(!n)try{n=qe(e).name}catch(t){n=`item with code ${e.code}`}n+=` at row ${e.row}, column ${e.column}`;let i=`Failed to parse ${n}`;t&&(i+=`: ${t}`),super(i),this.name="ItemParsingError"}}const We=["sock"];function Ye(t){const n=[];for(const{prop:i,min:o,max:r,param:s}of t){if(We.includes(i))continue;const{stats:t}=u[i];for(const{stat:i,type:a,param:l}of t){const t=e.findIndex((e=>(null==e?void 0:e.stat)===i));if(t<0)throw new Error(`Unknown mod ${i}`);const c=n[n.length-1],u={id:t,stat:i,priority:e[t].descPriority};switch(a){case"proc":n.push({...u,level:r,spell:Number(s),chance:o});break;case"charges":n.push({...u,level:r,spell:Number(s),charges:o,maxCharges:o});break;case"all":if(!("value"in c))throw new Error("No previous mod to copy");n.push({...u,value:c.value,param:c.param});break;case"min":n.push({...u,value:o});break;case"max":n.push({...u,value:r});break;case"param":n.push({...u,value:Number(s)});break;case"other":n.push({...u,value:r,param:s?"item_addskill_tab"===i?d[Number(s)].id:s:l})}}}return n}function Ve(e,n){if(e.modifiers||(e.modifiers=[]),"jew"===n.code)e.modifiers.push(...n.modifiers);else{const i=h[n.code];if(!i)throw new Re(e,"Only gems, runes and jewels can be put in sockets");const o=t[e.code];let r;r=o?"shie"===o.type||"head"===o.type||"ashd"===o.type?i.shield:i.armor:i.weapon,e.modifiers.push(...Ye(r))}}function Ge(e,t){return e.id===t.id&&"value"in e&&e.param===t.param}function Qe(e){var t,n,i,o,r,s,a,l,c,d,u,h,f,p;for(const m of e){let g;for(;(g=e.findIndex((e=>m!==e&&Ge(m,e))))>=0;){const[v]=e.splice(g,1);m.value=(null!==(t=m.value)&&void 0!==t?t:0)+(null!==(n=v.value)&&void 0!==n?n:0),(m.range||v.range)&&(m.range=[(null!==(r=null!==(o=null===(i=m.range)||void 0===i?void 0:i[0])&&void 0!==o?o:m.value)&&void 0!==r?r:0)+(null!==(l=null!==(a=null===(s=v.range)||void 0===s?void 0:s[0])&&void 0!==a?a:v.value)&&void 0!==l?l:0),(null!==(u=null!==(d=null===(c=m.range)||void 0===c?void 0:c[1])&&void 0!==d?d:m.value)&&void 0!==u?u:0)+(null!==(p=null!==(f=null===(h=v.range)||void 0===h?void 0:h[1])&&void 0!==f?f:v.value)&&void 0!==p?p:0)])}}}function Je(t,n=e[t.id]){var i,o,r,s,a,l;if(!n)return;let c=t.value;n.stat.endsWith("perlevel")&&(n.stat.includes("tohit")?c/=2:c/=8,c=Math.floor(99*c));let u,h,m,g,v=(null!=c?c:0)<0?n.descNeg:n.descPos;switch(v=v.replace("d%","d").replace(/(ÿc)[\w=]/g,"*"),n.descFunc){case 1:case 6:case 12:case 4:case 8:h=(null!=c?c:0)<0?`${c}`:`+${c}`;break;case 2:case 7:case 22:case 23:h=`${c}%`;break;case 3:case 9:h=`${c}`;break;case 5:h=`${Math.floor(100*c/128)}%`;break;case 11:v=v.replace("%d",""+100/c);break;case 13:v=p[t.param].skillsMod,h=`+${c}`,v=v.replace("%+d",h);break;case 14:m=d.find((({id:e})=>e===t.param)),m||t.param||(m=d[Number(t.value)]),v=`+${c} to ${m.name} ${p[m.charClass].classOnly}`;break;case 15:g="",null==f[t.spell]?console.error("NO SKILL FOUND:%s",t.spell):g=f[t.spell].name,v=v.replace("%d%%",`${t.chance}`).replace("%d",`${t.level}`).replace("%s",`${g}`);break;case 16:v=v.replace("%d",`${c}`).replace("%s",`${f[t.param].name}`);break;case 19:v=v.replace("%+d",`+${c}`).replace("%d",`${c}`).replace("%d",`${c}`);break;case 20:h=-c+"%";break;case 24:v=`${v.replace("%d/%d",`${t.charges}/${t.maxCharges}`).replace("%s",f[t.spell].name).replace("%d",`${t.level}`)} `;break;case 27:u=f[t.param],v=`+${c} to ${u.name} ${null==u.charClass?"":p[u.charClass].classOnly}`;break;case 28:v=`+${c} to ${f[t.param].name}`;break;case 100:(null===(i=t.values)||void 0===i?void 0:i[0])!==(null===(o=t.values)||void 0===o?void 0:o[1])&&(v=n.descNeg),v=v.replace("%d",`${null===(r=t.values)||void 0===r?void 0:r[0]}`).replace("%d",`${null===(s=t.values)||void 0===s?void 0:s[1]}`);break;case 101:v=(null===(a=t.values)||void 0===a?void 0:a[0])===(null===(l=t.values)||void 0===l?void 0:l[1])?v.replace("%d",`${Math.round(t.values[0]*t.values[2]/256)}`).replace("%d",`${Math.round(t.values[2]/25)}`):n.descNeg.replace("%d",`${Math.round(t.values[0]*t.values[2]/256)}`).replace("%d",`${Math.round(t.values[1]*t.values[2]/256)}`).replace("%d",`${Math.round(t.values[2]/25)}`)}if(v){v=v.replace("%d","").replace("%+d","");let e="";switch(n.descVal){case 1:e=`${h} ${v}`;break;case 2:e=`${v} ${h}`;break;default:e=v}return 6<=n.descFunc&&n.descFunc<=9&&(e+=` ${n.descAdditional}`),e}}function Xe(e,t){var n,i,o;const r=null!==(n=null==t?void 0:t.filter((({id:t})=>e.statsInGroup.includes(t))))&&void 0!==n?n:[];if(r.length!==e.statsInGroup.length)return!1;if(e.allEqual&&r.some((({value:e})=>e!==r[0].value)))return!1;if(e.isRange&&(null!==(i=r[0].value)&&void 0!==i?i:0)>(null!==(o=r[1].value)&&void 0!==o?o:0))return!1;if(("group:secondary-dmg"===e.stat||"group:min-dmg"===e.stat||"group:max-dmg"===e.stat)&&(null==t?void 0:t.find((e=>"group:primary-dmg"===e.stat)))){for(const e of r)delete e.description;return!1}const s={id:-1,stat:e.stat,priority:e.descPriority,value:e.allEqual?r[0].value:void 0,values:r.map((({value:e})=>null!=e?e:0))};s.description=Je(s,e),e.allEqual&&(s.range=r[0].range),null==t||t.push(s);for(const e of r)delete e.description;return!0}function Ze(e,t,n=""){for(const e of t)e.description=Je(e),e.description&&n&&(e.description+=n);!function(e){for(const t of m)Xe(t,e)}(t),t.sort((({priority:e,param:t},{priority:n,param:i})=>n-e||(null!=i?i:0)-(null!=t?t:0)));for(const{description:n}of t)n&&(e.search+=`${n}\n`)}function Ke(e){let t;if(e.unique)t=5===e.quality&&g[s[e.unique].set];else{const n=s.find((t=>t.name==e.name));t=5===e.quality&&g[n.set]}t&&(e.setGlobalModifiers=t.modifiers.map((e=>Ye(e))))}function et(e){var t,n;if((e.runeword||7===e.quality||5===e.quality)&&function(e){var t;if(!e.modifiers)return 0;let n,i=e.modifiers;if(e.runeword)n=[];else if(7===e.quality)n=r[e.unique].modifiers;else{if(5!==e.quality)throw new Error("Only uniques, sets and runewords have a perfection score.");n=[...s[e.unique].baseModifiers,...s[e.unique].setModifiers.flat()],i=[...e.modifiers,...e.setItemModifiers.flat()]}n=n.filter((({prop:e})=>"bloody"!==e));const o=qe(e);let a=0,l=0;function c(e,t,n){t!==n&&(a=(l*a+(e-t)/(n-t))/++l)}for(const t of n)t.min!==t.max&&("sock"!==t.prop?He(t,i,c):(e.socketsRange=[t.min,Math.min(t.max,o.maxSockets)],c(e.sockets,...e.socketsRange)));if((7===e.quality||5===e.quality)&&"def"in o&&!n.some((({prop:e})=>"ac%"===e))){const n=null!==(t=e.defense)&&void 0!==t?t:0,i=e.ethereal?1.5:1;e.defenseRange=[Math.floor(o.def[0]*i),Math.floor(o.def[1]*i)],c(n,...e.defenseRange)}e.perfectionScore=0===l?100:Math.floor(100*a)}(e),e.filledSockets)for(const t of e.filledSockets)Ve(e,t);if(e.modifiers&&(Qe(e.modifiers),Ze(e,e.modifiers)),5===e.quality&&(null===(t=e.setItemModifiers)||void 0===t||t.forEach(((t,n)=>{Ze(e,t,` (${n+2} items)`)})),Ke(e),null===(n=e.setGlobalModifiers)||void 0===n||n.forEach(((t,n)=>{Ze(e,t,n>=4?"":` (${n+2} items)`)}))),e.ethereal&&(e.search+="Ethereal\n"),e.sockets&&(e.search+=`Socketed (${e.sockets})\n`,e.search+=`${e.sockets} sockets\n`),e.filledSockets)for(const t of e.filledSockets)e.search+=`${t.name})\n`;e.search=e.search.toLowerCase()}function tt(t,n){var i,o;const r=new xe(t);if("aa55aa55"!==r.readInt32LE().toString(16))throw new Error("This does not look like a Diablo 2 character save (.d2s)");const s={filename:null!==(i=null==n?void 0:n.name)&&void 0!==i?i:"",lastModified:null!==(o=null==n?void 0:n.lastModified)&&void 0!==o?o:0,version:r.readInt32LE(4),name:r.readNullTerminatedString(20),class:r.readInt8(40),hasCorpse:!1,hasMercenary:!!r.readInt32LE(179),characterData:new Uint8Array,golem:new Uint8Array,items:[]};return function(t){var n,i;const o=t.readString(2,765);if("gf"!==o)throw new Error(`Unexpected header ${o} for an attributes list`);const r=Se(t);let s;for(;511!==(s=r.readInt(9));)r.readInt(null!==(i=null===(n=e[s])||void 0===n?void 0:n.charSize)&&void 0!==i?i:0)}(r),r.readString(32),s.characterData=r.read(r.nextIndex-16,16),s.items.push(...ze(r,s)),function(e,t){const n=e.readString(2);if("JM"!==n)throw new Error(`Unexpected header ${n} for corpse data`);const i=e.readInt16LE();t.hasCorpse=i>0;for(let n=0;n<i;n++){e.read(12);const n=ze(e,t);for(const e of n)e.corpse=!0;t.items.push(...n)}}(r,s),function(e,t){const n=e.readString(2);if("jf"!==n)throw new Error(`Unexpected header ${n} for mercenary data`);if(t.hasMercenary){const n=ze(e,t);for(const e of n)e.mercenary=!0;t.items.push(...n)}}(r,s),s.golem=r.readRemaining(),function(e){for(const t of e.items)t.owner=e,et(t)}(s),s}function nt(e,t){const n=e.readString(2);if("ST"!==n)throw new Error(`Unexpected header ${n} for a stash page`);e.peek=!0,e.readNullTerminatedString(),e.read(1);const i="JM"!==e.readString(2);let o;return e.peek=!1,i&&(o=e.readInt8(),e.read(3)),{flags:o,name:e.readNullTerminatedString(),items:ze(e,t)}}function it(e,t){var n,i,o;const r=new xe(e),s=r.readString(4);if("SSS\0"!==s&&"CSTM"!==s)throw new Error("This does not look like a plugy stash file (.sss or .d2x)");const a={filename:null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"",lastModified:null!==(i=null==t?void 0:t.lastModified)&&void 0!==i?i:0,version:96,personal:"CSTM"===s,pageFlags:!0,gold:0,pages:[]};a.nonPlugY=!a.personal&&(null==t?void 0:t.name.endsWith(".d2x"));let l=10;const c=r.readString(2);if("01"===c)a.personal&&(l+=4);else{if("02"!==c)throw new Error("Your version of PlugY is too old.");a.gold=r.readInt32LE(),l+=4}for(r.read(0,l);!r.done;)try{a.pages.push(nt(r,a))}catch(e){if(e instanceof Error)throw new Error(`${e.message} on page ${a.pages.length+1}`)}return a.pageFlags=void 0!==(null===(o=a.pages[0])||void 0===o?void 0:o.flags),function(e){e.pages.forEach((({items:t},n)=>{for(const i of t)i.owner=e,i.page=n,et(i)}))}(a),a}class ot{constructor(){this.raw=new Uint8Array(4096),this.dataView=new DataView(this.raw.buffer),this.nextIndex=0}done(){return this.raw=this.raw.slice(0,this.nextIndex),this.dataView=new DataView(this.raw.buffer),this.raw}get length(){return this.raw.length}skip(e){this.nextIndex+=e}write(e,t=this.nextIndex){const n=t+e.length;if(n>this.raw.length){const e=new Uint8Array(Math.max(this.raw.length+4096,n));e.set(this.raw),this.raw=e,this.dataView=new DataView(this.raw.buffer)}this.raw.set(e,t),this.nextIndex=n}writeString(e,t=this.nextIndex){const n=[];for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);this.write(n,t)}writeInt16LE(e,t=this.nextIndex){this.write(new Array(2).fill(0),t),this.dataView.setUint16(t,e,!0)}writeInt32LE(e,t=this.nextIndex){this.write(new Array(4).fill(0),t),this.dataView.setUint32(t,e,!0)}computeChecksum(){let e=0;for(const t of this.raw)e=e<<1|e>>>31,e+=t,e>>>=0;return e}}function rt(e,t){var n;e.writeString("JM"),e.writeInt16LE(t.length);for(const i of t){e.write(Ae(i.raw));for(const t of null!==(n=i.filledSockets)&&void 0!==n?n:[])e.write(Ae(t.raw))}}function st(e){return"pages"in e}function at(e){return"personal"in e}function lt(e){return"items"in e}function ct(e){return at(e)?e.personal?`${e.filename.slice(0,-4)}'s stash`:e.nonPlugY?"Offline stash":"PlugY shared stash":lt(e)?e.filename.slice(0,-4):"Shared"}function dt(e,t){const n=e.readInt32LE().toString(16);if("aa55aa55"!==n)throw new Error(`Unexpected header ${n} for a stash page`);e.read(8);const i={gold:e.readInt32LE(),items:[]};return e.read(48),i.items.push(...ze(e,t)),i}function ut(e,t){var n,i;const o=new xe(e);o.peek=!0;if("aa55aa55"!==o.readInt32LE().toString(16))throw new Error("This does not look like a Diablo 2 shared stash save (.d2i)");const r={filename:null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"",lastModified:null!==(i=null==t?void 0:t.lastModified)&&void 0!==i?i:0,version:o.readInt32LE(8),pages:[]};o.peek=!1;let s=1;for(;!o.done;)s++,console.log("%s STASH",s),r.pages.push(dt(o,r));return function(e){e.pages.forEach((({items:t},n)=>{for(const i of t)i.owner=e,i.page=n,et(i)}))}(r),r}async function ht(e){try{const t=new Uint8Array(await e.arrayBuffer());return e.name.endsWith(".d2s")?tt(t,e):e.name.endsWith(".d2i")?ut(t,e):it(t,e)}catch(e){throw e instanceof Error&&alert(e.message),e}}function ft(e){let t,n;return at(e)?(t=function(e){const t=new ot;e.personal?(t.writeString("CSTM"),t.writeString("01"),t.skip(4)):(t.writeString("SSS\0"),t.writeString("02"),t.writeInt32LE(e.gold)),t.writeInt32LE(e.pages.length);for(const n of e.pages)t.writeString("ST"),e.pageFlags&&(t.write([n.flags]),t.skip(3)),t.writeString(n.name),t.skip(1),rt(t,n.items);return t.done()}(e),n=e.personal?"CharacterName.d2x":"_LOD_SharedStashSave.sss"):lt(e)?(t=function(e){const t=new ot;t.writeInt32LE(parseInt("aa55aa55",16)),t.writeInt32LE(e.version),t.skip(8),t.write(e.characterData),rt(t,e.items.filter((e=>!e.mercenary&&!e.corpse)));const n=t.done();return t.writeInt32LE(t.length,8),t.writeInt32LE(t.computeChecksum(),12),n}(e),n="CharacterName.d2s"):(t=function(e){const t=new ot;for(const n of e.pages){const i=t.nextIndex;t.writeInt32LE(parseInt("aa55aa55",16)),t.skip(4),t.writeInt32LE(e.version),t.writeInt32LE(n.gold);const o=t.nextIndex;t.skip(48),rt(t,n.items);const r=t.nextIndex;t.writeInt32LE(r-i,o),t.write([],r)}return t.done()}(e),n="SharedStashSoftCoreV2.d2i"),new File([new Blob([t.buffer])],e.filename||n)}window.indexedDB||alert("Your browser doesn't support a stable version of IndexedDB. This application will not remember your stash between sessions.");const pt="save_files",mt=new Promise(((e,t)=>{const n=indexedDB.open("D2StashOrganizer",2);let i;n.onerror=function(){t("Unable to open IndexedDB")},n.onsuccess=function(){i?i.finally((()=>e(this.result))):e(this.result)},n.onupgradeneeded=function(e){const t=this.result,o=t.createObjectStore(pt,{keyPath:"name"});if(e.oldVersion<1){const e=localStorage.getItem("stash");e&&(o.transaction.oncomplete=()=>{t.transaction(pt,"readwrite").objectStore(pt).add(ft(JSON.parse(e)))})}else e.oldVersion<2&&(i=new Promise(((e,t)=>{const i=n.transaction.objectStore("stash").get(0);i.onsuccess=function(){if(this.result){const i=n.transaction.objectStore(pt).add(this.result);i.onsuccess=()=>e(),i.onerror=()=>t()}else e()},i.onerror=()=>t()})))}}));function gt(e){return mt.then((t=>new Promise(((n,i)=>{const o=t.transaction(pt,"readwrite").objectStore(pt).put(e);o.onerror=function(){i("Unable to store save file.")},o.onsuccess=function(){n()}}))))}function vt(e){return mt.then((t=>new Promise(((n,i)=>{const o=t.transaction(pt,"readwrite"),r=o.objectStore(pt);r.clear();for(const t of e)r.add(t);o.onerror=function(){i("Unable to store save files.")},o.oncomplete=function(){n()}}))))}async function bt(){const e=await mt.then((e=>new Promise(((t,n)=>{const i=e.transaction(pt,"readonly").objectStore(pt).getAll();i.onerror=function(){n("Unable to read save files.")},i.onsuccess=function(){t(this.result)}}))));return Promise.all(e.map((e=>ht(e))))}function wt(e,t=0){if(st(e)){const n=[];for(const{items:i}of e.pages.slice(t))n.push(...i);return n}return e.items}function yt(e){var t;let n="";for(const i of e){n+=i.raw;for(const e of null!==(t=i.filledSockets)&&void 0!==t?t:[])n+=e.raw}return n}const _t=Q({selectedItems:new Set,toggleItem:()=>{},selectAll:()=>{},unselectAll:()=>{},resetSelection:()=>{}});function kt({children:e}){const[t,n]=ue(new Set),i=me((e=>{n((t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}))}),[]),o=me((e=>t=>{n((n=>{const i=new Set(n);for(const n of t)i[e?"add":"delete"](n);return i}))}),[]),r=me((()=>{n(new Set)}),[]),s=pe((()=>({selectedItems:t,toggleItem:i,selectAll:o(!0),unselectAll:o(!1),resetSelection:r})),[t,i,o,r]);return X(_t.Provider,Object.assign({value:s},{children:e}),void 0)}const xt=Q({owners:[],allItems:[],hasPlugY:!1,setCollection:()=>{},setSingleFile:()=>{}});function St(e){e.sort(((e,t)=>ct(e).localeCompare(ct(t))));const t=e.some((e=>at(e)&&!e.nonPlugY)),n=t?function(e){const t=new Map;for(const n of e)at(n)&&n.pages.forEach(((e,i)=>{t.set(yt(e.items),[n,i])}));const n=new Map;for(const i of e){if(lt(i)){const e=t.get(yt(i.items.filter((({stored:e})=>5===e))));e&&n.set(i,e)}return n}}(e):void 0,i=e.flatMap((e=>{let t=wt(e);return lt(e)&&(null==n?void 0:n.has(e))&&(t=t.filter((e=>5!==e.stored))),t}));return{owners:e,allItems:i,hasPlugY:t,lastActivePlugyStashPage:n}}function Ot({children:e}){const{resetSelection:t}=ge(_t),[n,i]=ue({owners:[],allItems:[],hasPlugY:!1}),o=me((e=>{i(St(e)),t()}),[t]),r=me((e=>{i((t=>{const n=[...t.owners],i=n.findIndex((t=>t.filename===e.filename));return i>=0?n.splice(i,1,e):n.push(e),St(n)})),t()}),[t]),s=pe((()=>({...n,setCollection:o,setSingleFile:r})),[n,o,r]);return he((()=>{bt().then((e=>{o(e),!window.location.hash&&e.length>0&&(window.location.hash="#saves")}))}),[o]),X(xt.Provider,Object.assign({value:s},{children:e}),void 0)}function jt(e){if(!e.quality||void 0===e.unique)return;let t;switch(e.quality){case 7:return t=r[e.unique],t.item=e,t;case 5:return t=s[e.unique],t.item=e,t;default:return}}function It(e,t){const n=new Map;for(const e of $e)for(const t of e)n.set(t,[]);for(const i of e){const e=qe(i),o=Pe.get(e.type)||"twoHanded"in e&&Pe.get(`${e.type}-${Number(e.twoHanded)}`);if(!o)continue;const r=n.get(o),s=t?e.tier:0;let a=r[s];a||(a=[],r[s]=a),a.push(i)}for(const[e,t]of n)n.set(e,t.filter((({length:e})=>e>0)));return n}function At(e){return"enabled"in e||(e=jt(e)),!!e&&(!qe(e).indestructible&&e.modifiers.every((({prop:e})=>"indestruct"!==e&&"ethereal"!==e)))}function qt(e=!1){let t=r.filter((e=>e.enabled&&e.qlevel>0));e&&(t=t.filter(At));const n=It(t,!0);for(const e of n.values())for(const t of e)t.sort(((e,t)=>e.qlevel-t.qlevel));return n}const Ct=[[{name:"Low level sets",maxLevel:20}],[{name:"Mid level sets",maxLevel:60}],[{name:"High level sets",maxLevel:100}]],Et=[],Mt=Object.entries(g);let $t=0;for(const[{maxLevel:e}]of Ct)Et.push(Mt.filter((([,{levelReq:t}])=>$t<=t&&t<e)).sort((([,e],[,t])=>e.levelReq-t.levelReq)).map((([e,{name:t}])=>{const n=t.lastIndexOf("'");n>=0&&!t.startsWith("Death")&&!t.startsWith("Heaven")&&!t.startsWith("Orphan")&&(t=t.slice(0,n));let i=t,o=t.indexOf("'",4);return o<0&&(o=t.indexOf(" ",4)),o>0&&(i=t.slice(0,o)),i.startsWith("The ")&&(i=i.slice(4)),{name:t,shortName:i,set:e}}))),$t=e;function Ut(e){const t=new Map;for(const e of Et)for(const{set:n}of e)t.set(g[n],[]);for(const n of e){const e="set"in n?n:s[n.unique];t.get(g[e.set]).push(n)}return t}function Pt(e,t){const n=jt(t);if(n){let i=e.get(n);i||(i=[],e.set(n,i)),i.push(t)}}function Nt(e){const t=new Map;for(const n of e)if(Pt(t,n),n.filledSockets)for(const e of n.filledSockets)Pt(t,e);const n=new Map;for(const[e,i]of qt())n.set(e,i.map((e=>e.map((n=>{var i,o;return{item:n||e,normal:!!t.get(n),ethereal:At(n)?!!(null===(i=t.get(n))||void 0===i?void 0:i.some((({ethereal:e})=>e))):void 0,perfect:!!(null===(o=t.get(n))||void 0===o?void 0:o.some((({perfectionScore:e})=>100===e)))}})))));for(const[e,i]of Ut(s))n.set(e,[i.map((e=>{var n;return{item:e,normal:!!t.get(e),ethereal:void 0,perfect:!!(null===(n=t.get(e))||void 0===n?void 0:n.some((({perfectionScore:e})=>100===e)))}}))]);return n}function Tt(){const{allItems:e}=ge(xt),{nbNormal:t,totalNormal:n,nbEth:i,totalEth:o,nbPerfect:r}=pe((()=>function(e){const t={nbNormal:0,totalNormal:0,nbEth:0,totalEth:0,nbPerfect:0,owners:[]};for(const n of Nt(e).values())for(const e of n)for(const{normal:n,ethereal:i,perfect:o}of e)t.totalNormal++,n&&t.nbNormal++,o&&t.nbPerfect++,void 0!==i&&(t.totalEth++,i&&t.nbEth++);return t}(e)),[e]);return X("div",{children:[X("p",{children:["Normal Grail: ",t," / ",n]},void 0),X("p",{children:["Eth Grail: ",i," / ",o]},void 0),X("p",{children:["Perfect Grail: ",r," / ",n]},void 0)]},void 0)}function Lt({item:e}){let t=e,n="";if(null==e)return X(C,{children:[void 0,void 0,n]},void 0);6===e.location&&(t=e.socketedIn,n=`, socketed in ${t.name}`);const i=function(e){if(!e.owner)return"Unknown location";const t=ct(e.owner);switch(e.location){case 0:switch(e.stored){case 5:return at(e.owner)?t:`In ${t}'s stash`;case 1:return`In ${t}'s inventory`;case 4:return`In ${t}'s cube`;default:return"Unknown location"}case 2:return`In ${t}'s belt`;case 1:return e.mercenary?`Worn by ${t}'s mercenary`:e.corpse?`On ${t}'s corpse`:`Worn by ${t}`;default:return"Unknown location"}}(t),o=void 0!==e.page?`, page ${e.page+1}`:"",r=`(${t.column+1}, ${t.row+1})`;return X(C,{children:[i,o,n,X("a",Object.assign({class:"location"},{children:[" ",r]}),void 0)]},void 0)}Z('.found{color:#6fb76f}.found:after{content:" ✔"}.missing{color:#ff6f6f}.missing:after{content:" ✘"}.location{color:#afafaf;font-size:smaller;font-weight:lighter}#grail-tracker{margin-top:1em}#grail-tracker th{font-weight:inherit;text-align:left}#grail-tracker td{padding:0 1em}#grail-tracker td[colspan]{padding-top:1em;text-align:center}#collection{border-collapse:collapse;margin-top:2em;width:100%}');Z(".tooltip-container{position:relative}.tooltip-trigger{cursor:pointer}.tooltip-content{bottom:-1px;height:1px;overflow:hidden;position:fixed;text-align:center;white-space:nowrap;width:1px}.tooltip-container:focus-within .tooltip-content,.tooltip-container:hover .tooltip-content{background:rgba(0,0,0,.9);border:2px solid #fff;bottom:calc(50% + .4em);height:auto;left:0;padding:.4em .8em;position:absolute;width:auto}");let Bt=0;function Dt({range:e}){return e?X("span",Object.assign({class:"sidenote"},{children:[" [",e.join(" - "),"]"]}),void 0):null}function Ft({item:e,noItem:t}){var n,i,o,r,s,a,l,c;const[d]=ue((()=>"item-tooltip-"+Bt++));if(t||(t={}),null==e){const o={};o.code=t.code,o.name=t.name,o.quality=t.setModifiers?5:7,null!=t.modifiers&&(o.modifiers=Ye(t.modifiers)),null!=t.baseModifiers&&(o.modifiers=Ye(t.baseModifiers)),null!=o.modifiers&&(Qe(o.modifiers),o.modifiers&&Ze(o,o.modifiers)),t.setModifiers&&(null===(n=o.setItemModifiers)||void 0===n||n.forEach(((e,t)=>{Ze(o,e,` (${t+2} items)`)})),Ke(o),null===(i=o.setGlobalModifiers)||void 0===i||i.forEach(((e,t)=>{Ze(o,e,t>=4?"":` (${t+2} items)`)}))),e=o}const u=function(e){if(e.runeword)return"unique";switch(e.quality){case 4:return"magic";case 6:return"rare";case 7:return"unique";case 5:return"set";case 8:return"crafted"}return e.sockets||e.ethereal?"socketed":""}(e);if(e.simple)return X("span",Object.assign({class:u},{children:e.name}),void 0);const h=qe(e),f=null!==(r=null===(o=e.modifiers)||void 0===o?void 0:o.map((({description:e,range:t})=>e&&X("div",Object.assign({class:"magic"},{children:[e,X(Dt,{range:t},void 0)]}),void 0))))&&void 0!==r?r:[];if(e.ethereal||e.sockets){const t=[e.ethereal&&"Ethereal",e.sockets&&`Socketed (${e.sockets})`].filter((e=>!!e));null==f||f.push(X("div",Object.assign({class:"magic"},{children:[t.join(", "),X(Dt,{range:e.socketsRange},void 0)]}),void 0))}const p=null===(s=e.setItemModifiers)||void 0===s?void 0:s.flatMap((e=>e.map((({description:e,range:t})=>e&&X("div",Object.assign({class:"set"},{children:[e," ",X(Dt,{range:t},void 0)]}),void 0))))),m=null===(a=e.setGlobalModifiers)||void 0===a?void 0:a.flatMap((e=>e.map((({description:e})=>e&&X("div",Object.assign({class:"unique"},{children:e}),void 0)))));return null==m||m.unshift(X("br",{},void 0)),X("span",Object.assign({class:"tooltip-container"},{children:[X("span",Object.assign({class:`tooltip-trigger ${u}`,tabIndex:0,"aria-describedby":d},{children:e.name}),void 0),X("div",Object.assign({id:d,class:"tooltip-content",role:"tooltip"},{children:[X("div",Object.assign({class:u},{children:e.name}),void 0),X("div",Object.assign({class:u},{children:null==h?void 0:h.name}),void 0),X("div",{children:["Item Level: ",e.level]},void 0),"def"in h&&X("div",{children:["Defense:"," ",X("span",Object.assign({class:e.enhancedDefense?"magic":""},{children:[e.defense,X(Dt,{range:e.defenseRange},void 0)]}),void 0)]},void 0),e.durability&&X("div",{children:["Durability: ",null===(l=e.durability)||void 0===l?void 0:l[0]," of"," ",e.durability[1]+(null!==(c=e.extraDurability)&&void 0!==c?c:0)]},void 0),f,p,m]}),void 0)]}),void 0)}const zt=["Normal","Exceptional","Elite"],Ht=e=>e?"found":"missing";function Rt(){const{allItems:e}=ge(xt),[t,n]=ue("all"),i=pe((()=>Nt(e)),[e]),o=pe((()=>{const e=[];for(const[n,o]of i)o.forEach(((i,r)=>{const s=[];for(const{item:e,normal:n,ethereal:o,perfect:r}of i)n&&"missing"===t||r&&"perfect"===t||(void 0===o||o)&&"ethereal"===t||s.push(X("tr",{children:[X("th",Object.assign({scope:"row","aria-label":e.name},{children:X(Ft,{item:e.item,noItem:e},void 0)}),void 0),X("td",Object.assign({class:Ht(n)},{children:"Normal"}),void 0),X("td",void 0===o?{children:X("span",{"aria-label":"Not applicable"},void 0)}:Object.assign({class:Ht(o)},{children:"Ethereal"}),void 0),X("td",Object.assign({class:Ht(r)},{children:"Perfect"}),void 0),X("td",Object.assign({class:"location"},{children:[X("td",{children:X(Lt,{item:e.item},void 0)},void 0)," "]}),void 0)]},void 0));if(0===s.length)return;const a=o.length>1?`${zt[r]} ${n.name}`:n.name;e.push(X("tbody",{children:[X("tr",{children:X("td",Object.assign({colSpan:5},{children:a}),void 0)},void 0),s]},void 0))}));return e}),[t,i]);return X(C,{children:[X("div",Object.assign({class:"controls"},{children:[X(Tt,{},void 0),X("div",{children:[X("p",{children:X("label",Object.assign({for:"grail-filter"},{children:"Show:"}),void 0)},void 0),X("p",{children:X("select",Object.assign({id:"grail-filter",value:t,onChange:({currentTarget:e})=>n(e.value)},{children:[X("option",Object.assign({value:"all"},{children:"All items"}),void 0),X("option",Object.assign({value:"missing"},{children:"Missing items"}),void 0),X("option",Object.assign({value:"ethereal"},{children:"Missing ethereal items"}),void 0),X("option",Object.assign({value:"perfect"},{children:"Missing perfect items"}),void 0)]}),void 0)},void 0)]},void 0)]}),void 0),X("table",Object.assign({id:"grail-tracker"},{children:o}),void 0)]},void 0)}function Wt({nbEntries:e,pageSize:t,currentEntry:n,onChange:i,text:o}){const r=Math.floor((e-1)/t)*t;return he((()=>{n>=e&&i(0)}),[e,n,i]),r<=0?null:X("div",Object.assign({class:"pagination"},{children:[X("div",Object.assign({style:{visibility:0===n?"hidden":"visible"}},{children:[X("button",Object.assign({class:"button",onClick:()=>i(0)},{children:"First"}),void 0),X("button",Object.assign({class:"button",onClick:()=>i((e=>e-t))},{children:"Previous"}),void 0)]}),void 0),X("span",{children:o(n+1,Math.min(n+t,e))},void 0),X("div",Object.assign({style:{visibility:n>=r?"hidden":"visible"}},{children:[X("button",Object.assign({class:"button",onClick:()=>i((e=>e+t))},{children:"Next"}),void 0),X("button",Object.assign({class:"button",onClick:()=>i(r)},{children:"Last"}),void 0)]}),void 0)]}),void 0)}Z(".pagination{display:flex;flex-flow:row nowrap;justify-content:space-between;margin:2em 0}.pagination button:first-child{margin-right:1em}.pagination button[disabled]{cursor:default;opacity:0}");const Yt=Array(14).fill(0).map(((e,t)=>t)),Vt=Array(17).fill(0).map(((e,t)=>t));function Gt(e,t=!1,n=!1){const i=new Map;let o=-1,r=0,s=0,a=0;function l(){o++,r=0,s=0,a=0}let c=!1;for(let d=0;d<e.length;d++){0===d||n?l():(r=a,(c||0<a&&a<3*(3-e.length+d))&&(c=!0,r+=2),s=0,a=r);for(const c of e[d]){const d=qe(c);if(s+d[t?"height":"width"]>(t?14:17)&&(r=a,s=0),r+d[t?"width":"height"]>(t?17:14)){if(!n)return Gt(e,t,!0);l()}i.set(c,{page:o,rows:[t?s:r],cols:[t?r:s]}),s+=d[t?"height":"width"],a=Math.max(a,r+d[t?"width":"height"])}!n&&0===d&&e.length>2&&(n=a>3)}return{nbPages:o+1,positions:i}}function Qt(e){return Number(e.code.slice(1))}function Jt(e,t){switch(e){case"single-line":return function(e){const t=new Map;let n=0;for(const i of e)for(const e of i){const i=qe(e);if(console.warn(`base ${i.name} w: ${i.width}, col: ${n}`),n+i.width>2e3)throw new Error(`Single-line layout ran out of space for ${e.name} ${n} + ${i.width} > 17`);t.set(e,{page:0,rows:Yt,cols:[n]}),n+=i.width}return{nbPages:Math.sign(e.length),positions:t}}(t);case"single-column":return function(e){const t=new Map;let n=0;for(const i of e)for(const e of i){const i=qe(e);if(n+i.height>11111)throw new Error(`Single-column layout ran out of space for ${e.name}`);t.set(e,{page:0,rows:[n],cols:Vt}),n+=i.height}return{nbPages:Math.sign(e.length),positions:t}}(t);case"set":return function([e]){const t=new Map;for(const n of e){const{type:e}=qe(n);switch(e){case"ring":t.set(n,{page:0,rows:[6],cols:[3,6]});break;case"amul":t.set(n,{page:0,rows:[2],cols:[6]});break;case"tors":t.set(n,{page:0,rows:[3],cols:[4]});break;case"helm":case"circ":case"phlm":case"pelt":t.set(n,{page:0,rows:[0],cols:[4]});break;case"glov":t.set(n,{page:0,rows:[7],cols:[1]});break;case"belt":t.set(n,{page:0,rows:[7],cols:[4]});break;case"boot":t.set(n,{page:0,rows:[7],cols:[7]});break;case"shie":case"head":case"ashd":t.set(n,{page:0,rows:[2],cols:[7]});break;default:if("7wd"===n.code){t.set(n,{page:0,rows:[2],cols:[7]});break}t.set(n,{page:0,rows:[2],cols:[1]})}}return{nbPages:1,positions:t}}(t);case"runes":return function([e]){const t=new Map;e.sort(((e,t)=>Qt(e)-Qt(t)));const n=[];let i=0;for(let t=1;t<34;t++){const o=[];for(;i<e.length&&Qt(e[i])===t;)o.push(e[i]),i++;n.push(o)}let o=0,r=-2,s=0;function a(e,n){for(const i of e){if(s+1>17&&(r++,s=0),r+1>14&&(o++,r=0,s=0,!n))return a(e,!0);t.set(i,{page:o,rows:[r],cols:[s]}),s++}}for(const e of n)r+=2,s=0,a(e,0===r);return{nbPages:o+1,positions:t}}(t);case"tier-lines":return Gt(t,!1);case"tier-columns":return Gt(t,!0);default:return function(e){const t=new Map;if(0===e.length)return{nbPages:0,positions:t};let n=0,i=0,o=0,r=0;function s(e,a){for(const l of e){const c=qe(l);if(o+c.width>17&&(i=r,o=0),i+c.height>14&&(n++,i=0,o=0,r=0,!a))return s(e,!0);t.set(l,{page:n,rows:[i],cols:[o]}),o+=c.width,r=Math.max(r,i+c.height)}}for(const t of e)i=r,o=0,s(t,0===i);return{nbPages:n+1,positions:t}}(t)}}function Xt(e,t){void 0!==e.flags&&(e.flags+=2,t&&(e.flags+=4))}function Zt(e,t,n=!1){return e.sort(((e,i)=>(n?-1:1)*(t(e)-t(i)))).reduce(((e,n)=>{let i=e[e.length-1];return i&&t(i[0])===t(n)||(i=[],e.push(i)),i.push(n),e}),[])}function Kt(e,t,n){const i={name:`# ${t}`,items:[],flags:e.personal?0:1};return void 0===n?e.pages.push(i):e.pages.splice(n,0,i),i}function en(e,t){const{width:n,height:i}=qe(e),{width:o,height:r}=qe(t);return e.row+i>t.row&&t.row+r>e.row&&e.column+n>t.column&&t.column+o>e.column}const tn=Ie("JM");function nn(e){if(!(e.owner.version>=97)&&(e.raw=e.raw.slice(16,48)+e.version+e.raw.slice(58,76)+Me(e.code.padEnd(4," "))+e.raw.slice(108),e.filledSockets))for(const t of e.filledSockets)nn(t)}function on(e){if(e.owner.version<=96)return;const t=Me(e.code.padEnd(4," ")).length;if(e.raw=tn+e.raw.slice(0,32)+je(Number(e.version),10)+e.raw.slice(35,53)+Ie(e.code.padEnd(4," "))+e.raw.slice(53+t),e.filledSockets)for(const t of e.filledSockets)on(t)}function rn(e,[t,n]){const i=e.owner.version>=97?-23:0;e.column=t,e.row=n,e.raw=e.raw.slice(0,65+i)+je(t,4)+je(n,4)+e.raw.slice(73+i)}function sn(e,t,n,i,o){for(const n of e.pages){const e=n.items.indexOf(t);if(e>=0){n.items.splice(e,1);break}}if(!e.pages[n])throw new Error("Cannot move an item to a page that has not been created yet");const r={...t,row:i,column:o},s=e.pages[n].items.find((e=>en(r,e)));if(s)throw new Error(`Trying to move ${t.name} to the same spot as ${s.name}`);e.pages[n].items.push(t),t.owner=e,t.page=n,rn(t,[o,i])}const an=["tes","ceh","bet","fed","toa"];function ln(e,t){if(0===t.length)return;const n=Zt(t,(e=>an.indexOf(e.code))),i=e.pages.length,{nbPages:o,positions:r}=Jt("lines",n);for(let t=0;t<o;t++){const n=Kt(e,"Respecs");0===t&&Xt(n,!1)}for(const[t,{page:n,rows:o,cols:s}]of r.entries())sn(e,t,i+n,o[0],s[0])}const cn=["pk1","pk2","pk3","dhn","bey","mbr","std"];function dn(e,t){if(0===t.length)return;const n=Zt(t,(e=>cn.indexOf(e.code))),i=e.pages.length,{nbPages:o,positions:r}=Jt("lines",n);for(let t=0;t<o;t++){const n=Kt(e,"Ubers");0===t&&Xt(n,!1)}for(const[t,{page:n,rows:o,cols:s}]of r.entries())sn(e,t,i+n,o[0],s[0])}function un(e){return e.simple||an.includes(e.code)||cn.includes(e.code)}function hn({item:e,quantity:t}){var n;const i=[];return un(e)&&i.push(`Quantity: ${t}`),(e.runeword||7===e.quality||5===e.quality)&&(100===e.perfectionScore?i.push("Perfect"):i.push(`${e.perfectionScore}% perfect`)),e.ethereal&&i.push("Ethereal"),e.runeword&&i.push(qe(e).name),(null!==(n=e.quality)&&void 0!==n?n:10)<=3&&!e.runeword&&e.sockets&&i.push(`${e.sockets} sockets`),X(C,{children:i.join(", ")},void 0)}function fn({item:e}){return X("a",Object.assign({class:"location"},{children:[" ",e.itemType," "]}),void 0)}function pn({item:e,duplicates:t,selectable:n,withLocation:i}){const{selectedItems:o,toggleItem:r,selectAll:s,unselectAll:a}=ge(_t),l=me((()=>{t?o.has(e)?a(t):s(t):r(e)}),[t,e,s,o,r,a]);return X("tr",Object.assign({class:"item"},{children:[n&&X("td",{children:X("input",{type:"checkbox",checked:o.has(e),onChange:l,"aria-label":e.name},void 0)},void 0),X("th",Object.assign({scope:"row","aria-label":e.name},{children:[" ",X(fn,{item:e},void 0),X(Ft,{item:e},void 0)]}),void 0),X("td",{children:X(hn,{item:e,quantity:null==t?void 0:t.length},void 0)},void 0),i&&X("td",{children:X(Lt,{item:e},void 0)},void 0)]}),void 0)}Z(".item td,.item th{text-align:left}.item th{font-weight:inherit;width:400px}.item td:first-child{width:2em}");Z(".page-title{border-bottom:1px solid #666;display:flex;flex-flow:row;justify-content:space-between}.page{table-layout:fixed;width:100%}");function mn(e){return"name"in e?e.name||(void 0!==e.flags&&e.flags%2?"Shared Page #":"Personal Page #"):"Shared Page #"}function gn(e){const t=new Map;let n=0;for(const i of e)if(un(i)){const e=t.get(i.code);e?0!==e[0].location&&0===i.location||5!==e[0].stored&&5===i.stored?e.unshift(i):e.push(i):t.set(i.code,[i])}else t.set(""+n++,[i]);return Array.from(t.values())}function vn({page:e,index:t}){var n,i;const o=(null!==(n=e.flags)&&void 0!==n?n:0)>=4?"Main index":(null!==(i=e.flags)&&void 0!==i?i:0)>=2?"Index":"",r=pe((()=>gn(e.items)),[e.items]);return X("section",{children:[X("h3",Object.assign({class:"page-title"},{children:[X("span",{children:mn(e).replace("#",`${t+1}`)},void 0),X("span",{children:o},void 0)]}),void 0),X("table",Object.assign({class:"page"},{children:Array.from(r.values()).map(((e,t)=>{var n;return X(pn,{item:e[0],duplicates:e,selectable:!0,withLocation:!1},null!==(n=e[0].id)&&void 0!==n?n:t)}))}),void 0)]},void 0)}function bn({value:e,onChange:t,children:n}){return X("div",{children:[X("p",{children:X("label",Object.assign({for:"search-input"},{children:n}),void 0)},void 0),X("p",{children:X("input",{id:"search-input",type:"search",value:e,onInput:({currentTarget:e})=>t(e.value)},void 0)},void 0)]},void 0)}function wn(e,t,n){if(!t)return e;const i=t.toLocaleLowerCase().split(/"([^"]*)"|\s+/).filter(Boolean);return e.filter((e=>{const t=qe(e);return i.every((i=>{var o;return(null==n?void 0:n.toLocaleLowerCase().includes(i))||(null===(o=e.name)||void 0===o?void 0:o.toLocaleLowerCase().includes(i))||t.name.toLocaleLowerCase().includes(i)||e.search.includes(i)}))}))}function yn({value:e,onChange:t}){return X("div",{children:[X("p",{children:X("label",Object.assign({for:"quality-select"},{children:"Filter by quality:"}),void 0)},void 0),X("p",{children:X("select",Object.assign({id:"quality-select",value:e,onChange:({currentTarget:e})=>t(e.value)},{children:[X("option",Object.assign({value:"all"},{children:"All"}),void 0),X("option",Object.assign({value:"normal"},{children:"Non-magical"}),void 0),X("option",Object.assign({value:"superior"},{children:"Superior"}),void 0),X("option",Object.assign({value:"magic"},{children:"Magic"}),void 0),X("option",Object.assign({value:"rare"},{children:"Rare"}),void 0),X("option",Object.assign({value:"unique"},{children:"Unique"}),void 0),X("option",Object.assign({value:"dupu"},{children:"Duplicates(Unique)"}),void 0),X("option",Object.assign({value:"set"},{children:"Set"}),void 0),X("option",Object.assign({value:"dups"},{children:"Duplicates(Set)"}),void 0),X("option",Object.assign({value:"runeword"},{children:"Rune word"}),void 0),X("option",Object.assign({value:"crafted"},{children:"Crafted"}),void 0),X("option",Object.assign({value:"misc"},{children:"Non-equipment"}),void 0)]}),void 0)},void 0)]},void 0)}function _n(e,t){if("all"===t)return e;if("dups"===t||"dupu"===t){const n=new Set,i=new Set,o="dupu"===t?7:5;for(const t of e.filter((e=>e.quality===o)))n.has(t.name)?i.add(t.name):n.add(t.name);return e.filter((e=>e.quality===o&&i.has(e.name))).sort(((e,t)=>e.name>t.name?1:-1))}return e.filter((e=>{var n;switch(t){case"normal":return(null!==(n=e.quality)&&void 0!==n?n:10)<=3&&!e.runeword;case"superior":return 3===e.quality&&!e.runeword;case"magic":return 4===e.quality;case"rare":return 6===e.quality;case"unique":return 7===e.quality;case"set":return 5===e.quality;case"runeword":return e.runeword;case"crafted":return 8===e.quality;case"misc":return e.simple}}))}Z(".controls{align-items:center;border-bottom:1px solid #666;display:flex;flex-flow:row nowrap;padding:1em 0}.controls>:not(:last-child){border-right:1px solid #666;padding-right:2em}.controls>:not(:first-child){padding-left:2em}.controls p:first-child{margin-top:0}.controls p:last-child{margin-bottom:0}.controls input,.controls select{width:100%}");const kn=["Equipped","Corpse","Mercenary","Inventory","Cube","Belt","Stash","Unknown"];function xn(e){switch(e.location){case 0:switch(e.stored){case 5:return"Stash";case 1:return"Inventory";case 4:return"Cube";case 0:return"Unknown"}throw new Error(`Unknown storage type ${e.stored}`);case 2:return"Belt";case 1:return e.mercenary?"Mercenary":e.corpse?"Corpse":"Equipped";case 6:case 4:return"Unknown"}}function Sn({items:e}){const{selectedItems:t,selectAll:n,unselectAll:i}=ge(_t),o=pe((()=>e.every((e=>t.has(e)))),[e,t]);return X("div",{children:X("button",Object.assign({class:"button",onClick:()=>o?i(e):n(e)},{children:[o?"Unselect":"Select"," all ",e.length," item",e.length>1?"s":""]}),void 0)},void 0)}function On(){const{owners:e,lastActivePlugyStashPage:t}=ge(xt),[n,i]=ue((()=>Math.max(0,e.findIndex((e=>at(e)&&!e.personal))))),[o,r]=ue(""),[s,a]=ue("all"),[l,c]=ue(0),d=e[n],u=pe((()=>d?st(d)?d.pages:function(e,t){const n=new Map;function i(e,t){let i=n.get(e);i||(i={name:e,items:[]},n.set(e,i)),i.items.push(t)}for(const t of e.items)i(xn(t),t);return kn.map((e=>n.get(e))).filter((e=>!(!e||t&&"Stash"===e.name)))}(d,!!(null==t?void 0:t.get(d))):[]),[d,t]),h=pe((()=>{var e;return null!==(e=u.map(((e,t)=>({...e,name:mn(e).replace("#",`${t+1}`),items:_n(wn(e.items,o,"name"in e?e.name:""),s)}))).filter((({items:e})=>e.length>0)))&&void 0!==e?e:[]}),[u,o,s]),f=pe((()=>h.flatMap((({items:e})=>e))),[h]);he((()=>{c(0)}),[d]);const p=X(Wt,{nbEntries:h.length,pageSize:10,currentEntry:l,onChange:c,text:(e,t)=>`Pages ${e} - ${t} out of ${h.length}`},void 0);return X(C,{children:[X("div",Object.assign({class:"controls"},{children:[X("div",{children:[X("p",{children:X("label",Object.assign({for:"character-select"},{children:"Select a character:"}),void 0)},void 0),X("p",{children:X("select",Object.assign({id:"character-select",value:n,onChange:({currentTarget:e})=>i(Number(e.value))},{children:e.map(((e,t)=>X("option",Object.assign({value:t},{children:ct(e)}),void 0)))}),void 0)},void 0)]},void 0),X(bn,Object.assign({value:o,onChange:r},{children:"Search for an item or a page:"}),void 0),X(yn,{value:s,onChange:a},void 0),X(Sn,{items:f},void 0)]}),void 0),p,X("div",{children:h.slice(l,l+10).map(((e,t)=>X(vn,{page:e,index:t+l},t)))},void 0),p]},void 0)}Z("#navigation{align-items:flex-end;border-bottom:1px solid #666;display:flex;flex-flow:row nowrap}a.nav-link{color:#aaa;margin:0 1em;padding-bottom:.4em;text-decoration:none}a.nav-link.active{border-bottom:1px solid #fff;color:#fff;margin-bottom:-1px}");Z("#collection{border-collapse:collapse;margin-top:2em;width:100%}#collection thead th{padding-bottom:.4em}#collection .item td:not(:first-child){padding:0 2em}#collection tbody .item th{padding-top:.3em}#collection tr{border-bottom:1px solid #222}#collection tbody tr:hover td:not(:first-child){color:#6fb76f}");const jn=Object.entries(Ne).map((([e,t])=>X("option",Object.assign({value:e},{children:t}),e)));function In({value:e,onChange:t}){return X("div",{children:[X("p",{children:X("label",Object.assign({for:"type-select"},{children:"Filter by type:"}),void 0)},void 0),X("p",{children:X("select",Object.assign({id:"type-select",value:e,onChange:({currentTarget:e})=>t(e.value)},{children:[jn,X("option",Object.assign({value:"all"},{children:"All"}),void 0)]}),void 0)},void 0)]},void 0)}function An({items:e,pageSize:t,selectable:n}){const[i,o]=ue(0),r=pe((()=>gn(e)),[e]);return he((()=>{o(0)}),[e]),X(C,{children:[X(Wt,{nbEntries:r.length,pageSize:t,currentEntry:i,onChange:o,text:(t,n)=>X(C,{children:["Items ",t," - ",n," out of ",r.length," ",X("span",Object.assign({class:"sidenote"},{children:["(",e.length," with duplicates)"]}),void 0)]},void 0)},void 0),X("table",Object.assign({id:"collection"},{children:[X("thead",{children:X("tr",Object.assign({class:"sidenote"},{children:[X("th",{children:X("span",Object.assign({class:"sr-only"},{children:"Select"}),void 0)},void 0),X("th",{children:"Item"},void 0),X("th",{children:"Characteristics"},void 0),X("th",{children:"Location"},void 0)]}),void 0)},void 0),X("tbody",{children:r.slice(i,i+t).map(((e,t)=>{var i;return X(pn,{item:e[0],duplicates:e,selectable:n,withLocation:!0},null!==(i=e[0].id)&&void 0!==i?i:t)}))},void 0)]}),void 0)]},void 0)}function qn(){const{allItems:e}=ge(xt),[t,n]=ue(""),[i,o]=ue("all"),[r,s]=ue("all"),[a,l]=ue(20),c=pe((()=>_n(wn(function(e,t){return"all"===t?e:e.filter((e=>t.includes(e.itemType)))}(wn(e,t),r),t),i)),[e,t,i,r]);return X(C,{children:[X("div",Object.assign({class:"controls"},{children:[X(bn,Object.assign({value:t,onChange:n},{children:"Search for an item:"}),void 0),X(yn,{value:i,onChange:o},void 0),X(In,{value:r,onChange:s},void 0),X("div",{children:[X("p",{children:X("label",Object.assign({for:"page-size-select"},{children:"Items per page:"}),void 0)},void 0),X("p",{children:X("select",Object.assign({id:"page-size-select",value:a,onChange:({currentTarget:e})=>l(Number(e.value))},{children:[X("option",Object.assign({value:10},{children:"10"}),void 0),X("option",Object.assign({value:20},{children:"20"}),void 0),X("option",Object.assign({value:50},{children:"50"}),void 0),X("option",Object.assign({value:100},{children:"100"}),void 0)]}),void 0)},void 0)]},void 0),X(Sn,{items:c},void 0)]}),void 0),X(An,{items:c,selectable:!0,pageSize:a},void 0)]},void 0)}function Cn({folder:e,children:t}){const{setCollection:n,setSingleFile:i}=ge(xt),o=fe(null),r=me((async()=>{var t;if(null===(t=o.current)||void 0===t?void 0:t.files){const t=[];for(const e of o.current.files)e.webkitRelativePath.split("/").length>2||(e.name.endsWith(".sss")||e.name.endsWith(".d2x")||e.name.endsWith(".d2s")||e.name.endsWith(".d2i"))&&t.push(e);if(e)await vt(t),n(await Promise.all(t.map((e=>ht(e)))));else{const e=t[0];await gt(e),i(await ht(e))}o.current.value=""}}),[e,n,i]),s=e?{directory:!0,webkitdirectory:!0,multiple:!0}:{accept:".sss,.d2x,.d2s,.d2i"};return X("span",Object.assign({class:"filepicker"},{children:[X("button",Object.assign({class:e?"button":"button danger",onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.click()}},{children:t}),void 0),X("input",Object.assign({class:"hidden",ref:o,type:"file"},s,{onChange:r}),void 0)]}),void 0)}Z("#save-files{border-collapse:collapse}#save-files td,#save-files th{border:1px solid #666;padding:.4em 1em}.filepicker:first-child{margin-right:1em}");function En({owner:e}){return at(e)?e.personal?X(C,{children:[X("span",Object.assign({class:"unique"},{children:e.filename.slice(0,-4)}),void 0),"'s stash"]},void 0):X("span",Object.assign({class:"magic"},{children:e.nonPlugY?"Offline stash":"PlugY shared stash"}),void 0):lt(e)?X("span",Object.assign({class:"unique"},{children:e.filename.slice(0,-4)}),void 0):X("span",Object.assign({class:"magic"},{children:"Shared"}),void 0)}const Mn=Intl.DateTimeFormat(void 0,{dateStyle:"long",timeStyle:"medium"});function $n(){const{owners:e}=ge(xt),[t,n]=ue(!1),i=pe((()=>{const t=[];for(const n of e)t.push(X("tr",{children:[X("td",{children:X(En,{owner:n},void 0)},void 0),X("td",{children:n.version<=96?"Legacy Diablo 2":"Diablo 2 Resurrected"},void 0),X("td",{children:Mn.format(new Date(n.lastModified))},void 0)]},void 0));return t}),[e]);return X(C,{children:[X("p",Object.assign({class:"sidenote"},{children:"Simply select your Diablo 2 save folder, and this tool will detect all items on every character and in every stash."}),void 0),X("p",{children:[X(Cn,Object.assign({folder:!0},{children:[0===e.length?"Upload":"Refresh"," all my save files"]}),void 0),!t&&X("button",Object.assign({class:"button sidenote",onClick:()=>window.confirm("Uploading a single stash at a time is not recommended, because you risk losing items that were moved between characters since the last upload or download.\n\nAre you sure you want to proceed?")&&n(!0)},{children:"Let me select a single file"}),void 0),t&&X(Cn,Object.assign({folder:!1},{children:[0===e.length?"Upload":"Update"," a single file"]}),void 0)]},void 0),X("table",Object.assign({id:"save-files"},{children:[X("tr",{children:[X("th",{children:"Character name"},void 0),X("th",{children:"Game version"},void 0),X("th",{children:"Save date"},void 0)]},void 0),i]}),void 0)]},void 0)}Z("#transfer-items ul{list-style:none;margin:0;padding:0}#transfer-items .selectors{align-items:center;display:flex}.selectors .arrow{font-size:2em;margin:0 2em}#source-selector{flex:0 0 auto}#transfer-items .error{margin-left:2em}#transfer-items .success{color:#6fb76f;margin-left:2em}#transfer-items h4{border-top:1px solid #666;margin-top:3em;padding-top:.4em}#transfer-items .pagination{margin-top:0}"),"stream"in Blob.prototype||Object.defineProperty(Blob.prototype,"stream",{value(){return new Response(this).body}}),"setBigUint64"in DataView.prototype||Object.defineProperty(DataView.prototype,"setBigUint64",{value(e,t,n){const i=Number(0xffffffffn&t),o=Number(t>>32n);this.setUint32(e+(n?0:4),i,n),this.setUint32(e+(n?4:0),o,n)}});var Un=e=>new DataView(new ArrayBuffer(e)),Pn=e=>new Uint8Array(e.buffer||e),Nn=e=>Math.min(4294967295,Number(e)),Tn=e=>Math.min(65535,Number(e));function Ln(e,t,n){if(void 0===t||t instanceof Uint8Array||(t=Fn(t)),void 0===n||n instanceof Date||(n=new Date(n)),e instanceof File)return{i:t||Fn(e.name),o:n||new Date(e.lastModified),A:e.stream()};if(e instanceof Response){const i=e.headers.get("content-disposition"),o=i&&i.match(/;\s*filename\*?=["']?(.*?)["']?$/i),r=o&&o[1]||new URL(e.url).pathname.split("/").pop(),s=r&&decodeURIComponent(r);return{i:t||Fn(s),o:n||new Date(e.headers.get("Last-Modified")||Date.now()),A:e.body}}if(!t||0===t.length)throw new Error("The file must have a name.");if(void 0===n)n=new Date;else if(isNaN(n))throw new Error("Invalid modification date.");if("string"==typeof e)return{i:t,o:n,A:Fn(e)};if(e instanceof Blob)return{i:t,o:n,A:e.stream()};if(e instanceof Uint8Array||e instanceof ReadableStream)return{i:t,o:n,A:e};if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return{i:t,o:n,A:Pn(e)};if(Symbol.asyncIterator in e)return{i:t,o:n,A:Bn(e)};throw new TypeError("Unsupported input format.")}function Bn(e){const t="next"in e?e:e[Symbol.asyncIterator]();return new ReadableStream({async pull(e){let n=0;for(;e.desiredSize>n;){const i=await t.next();if(!i.value){e.close();break}{const t=Dn(i.value);e.enqueue(t),n+=t.byteLength}}}})}function Dn(e){return"string"==typeof e?Fn(e):e instanceof Uint8Array?e:Pn(e)}function Fn(e){return(new TextEncoder).encode(String(e))}var zn=new WebAssembly.Instance(new WebAssembly.Module(Uint8Array.from(atob("AGFzbQEAAAABCgJgAABgAn9/AXwDAwIAAQUDAQACBw0DAW0CAAF0AAABYwABCpUBAkkBA38DQCABIQBBACECA0AgAEEBdiAAQQFxQaCG4u1+bHMhACACQQFqIgJBCEcNAAsgAUECdCAANgIAIAFBAWoiAUGAAkcNAAsLSQEBfyABQX9zIQFBgIAEIQJBgIAEIABqIQADQCABQf8BcSACLQAAc0ECdCgCACABQQh2cyEBIAJBAWoiAiAASQ0ACyABQX9zuAs"),(e=>e.charCodeAt(0))))),{t:Hn,c:Rn,m:Wn}=zn.exports;Hn();var Yn=Pn(Wn).subarray(65536);function Vn(e,t=0){for(const n of function*(e){for(;e.length>65536;)yield e.subarray(0,65536),e=e.subarray(65536);e.length&&(yield e)}(e))Yn.set(n),t=Rn(n.length,t);return t}function Gn(e,t,n=0){const i=e.getSeconds()>>1|e.getMinutes()<<5|e.getHours()<<11,o=e.getDate()|e.getMonth()+1<<5|e.getFullYear()-1980<<9;t.setUint16(n,i,1),t.setUint16(n+2,o,1)}function Qn(e){const t=Un(30);return t.setUint32(0,1347093252),t.setUint32(4,754976768),Gn(e.o,t,10),t.setUint16(26,e.i.length,1),Pn(t)}async function*Jn(e){let{A:t}=e;if("then"in t&&(t=await t),t instanceof Uint8Array)yield t,e.u=Vn(t,0),e.l=BigInt(t.length);else{e.l=0n;const n=t.getReader();for(;;){const{value:t,done:i}=await n.read();if(i)break;e.u=Vn(t,e.u),e.l+=BigInt(t.length),yield t}}}function Xn(e,t){const n=Un(16+(t?8:0));return n.setUint32(0,1347094280),n.setUint32(4,e.u,1),t?(n.setBigUint64(8,e.l,1),n.setBigUint64(16,e.l,1)):(n.setUint32(8,Nn(e.l),1),n.setUint32(12,Nn(e.l),1)),Pn(n)}function Zn(e,t,n){const i=Un(46);return i.setUint32(0,1347092738),i.setUint32(4,755182848),i.setUint16(8,2048),Gn(e.o,i,12),i.setUint32(16,e.u,1),i.setUint32(20,Nn(e.l),1),i.setUint32(24,Nn(e.l),1),i.setUint16(28,e.i.length,1),i.setUint16(30,n?28:0,1),i.setUint16(40,33204,1),i.setUint32(42,Nn(t),1),Pn(i)}function Kn(e,t){const n=Un(28);return n.setUint16(0,1,1),n.setUint16(2,24,1),n.setBigUint64(4,e.l,1),n.setBigUint64(12,e.l,1),n.setBigUint64(20,t,1),Pn(n)}function ei(e,t){const n=window.document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(n.href)}async function ti(e){const t=await(e=>new Response(Bn(async function*(e){const t=[];let n=0n,i=0n,o=0;for await(const r of e){yield Qn(r),yield r.i,yield*Jn(r);const e=r.l>=0xffffffffn||n>=0xffffffffn;yield Xn(r,e),t.push(Zn(r,n,e)),t.push(r.i),e&&(t.push(Kn(r,n)),n+=8n),i++,n+=BigInt(46+r.i.length)+r.l,o||(o=e)}let r=0n;for(const e of t)yield e,r+=BigInt(e.length);if(o||n>=0xffffffffn){const e=Un(76);e.setUint32(0,1347094022),e.setBigUint64(4,BigInt(44),1),e.setUint32(12,755182848),e.setBigUint64(24,i,1),e.setBigUint64(32,i,1),e.setBigUint64(40,r,1),e.setBigUint64(48,n,1),e.setUint32(56,1347094023),e.setBigUint64(64,n+r,1),e.setUint32(72,1,1),yield Pn(e)}const s=Un(22);s.setUint32(0,1347093766),s.setUint16(8,Tn(i),1),s.setUint16(10,Tn(i),1),s.setUint32(12,Nn(r),1),s.setUint32(16,Nn(n),1),yield Pn(s)}(async function*(e){for await(const t of e)t instanceof File||t instanceof Response?yield Ln(t):yield Ln(t.input,t.name,t.lastModified)}(e))),{headers:{"Content-Type":"application/zip","Content-Disposition":"attachment"}}))(e).blob();ei(t,"D2Save.zip")}const ni=["unknown","rejuvs","respecs","ubers","gems","runes","runewords","uniques","sets"];function ii(e){var i;const o=qe(e);return"rpot"===o.type?"rejuvs":an.includes(e.code)?"respecs":cn.includes(e.code)?"ubers":o.type.startsWith("gem")?"gems":"rune"===o.type?"runes":(null!==(i=e.quality)&&void 0!==i?i:10)<=3&&(e.code in t||e.code in n)?"runewords":5===e.quality?"sets":Ue.includes(o.type)?"uniques":"unknown"}function oi(e,t){if(0===t.length)return;const n=e.pages.length,{nbPages:i,positions:o}=Jt("lines",[t]);for(let t=0;t<i;t++){const n=Kt(e,"Unrecognized");0===t&&Xt(n,!0)}for(const[t,{page:i,rows:r,cols:s}]of o.entries())sn(e,t,n+i,r[0],s[0])}function ri(e,t){return e.code.localeCompare(t.code)}function si(e,t){if(0===t.length)return;t.sort(ri);const n=e.pages.length,{nbPages:i,positions:o}=Jt("lines",[t]);for(let t=0;t<i;t++){const n=Kt(e,"Rejuvs");0===t&&Xt(n,!0)}for(const[t,{page:i,rows:r,cols:s}]of o.entries())sn(e,t,n+i,r[0],s[0])}const ai=["gsy","gsv","gsb","gsr","gsg","gsw","sku"],li=ai.map((e=>i[e].type)),ci=ai.map((e=>i[e].name)),di=["c","f","u","s","l","z","p"];function ui(e,t){if(0===t.length)return;const n=ai.map((()=>[]));for(const e of t)n[li.indexOf(i[e.code].type)].push(e);const o=n.map(((e,t)=>Zt(e,function(e=!1){return t=>di.indexOf(t.code.charAt(e?2:1))}(6===t))));let r=e.pages.length;for(let t=0;t<n.length;t++){const{nbPages:n,positions:i}=Jt("lines",o[t]);for(let i=0;i<n;i++){const n=Kt(e,ci[t]);0===i&&Xt(n,0===t)}for(const[t,{page:n,rows:o,cols:s}]of i.entries())sn(e,t,r+n,o[0],s[0]);r+=n}}function hi(e,t){const n=e.pages.length,{nbPages:i,positions:o}=Jt("runes",[t]);for(let t=0;t<i;t++){const n=Kt(e,"Runes");0===t&&Xt(n,!0)}for(const[t,{page:i,rows:r,cols:s}]of o.entries())sn(e,t,n+i,r[0],s[0])}function fi(e,t){return c[e.runewordId].levelReq-c[t.runewordId].levelReq}function pi(e,t){var n,i,o,r;const s=qe(e),a=qe(t);return Ue.indexOf(s.type)-Ue.indexOf(a.type)||a.qlevel-s.qlevel||(null!==(n=t.sockets)&&void 0!==n?n:0)-(null!==(i=e.sockets)&&void 0!==i?i:0)||(null!==(o=t.quality)&&void 0!==o?o:0)-(null!==(r=e.quality)&&void 0!==r?r:0)}function mi(e,t){if(0===t.length)return;const n=[],i=[];for(const e of t)e.runeword?n.push(e):i.push(e);n.sort(fi),i.sort(pi);let o=e.pages.length;[["Runewords",n],["Bases",i]].forEach((([t,n],i)=>{const{nbPages:r,positions:s}=Jt("lines",[n]);for(let n=0;n<r;n++){const o=Kt(e,t);0===n&&Xt(o,0===i)}for(const[t,{page:n,rows:i,cols:r}]of s.entries())sn(e,t,o+n,i[0],r[0]);o+=r}))}function gi(e,t,{positions:n},i){var o;const r=new Map,s=[];for(const a of t){const t=jt(a);if(!t){s.push(a);continue}const l=null!==(o=r.get(t))&&void 0!==o?o:0,c=n.get(t);if(!c)throw new Error(`Unknown position for grail item ${t.name}`);const{page:d,rows:u,cols:h}=c;l>=u.length*h.length?s.push(a):(sn(e,a,d+i,u[l%u.length],h[Math.floor(l/u.length)]),r.set(t,l+1))}return s}function vi(e,t){return Ue.indexOf(qe(e).type)-Ue.indexOf(qe(t).type)}function bi(e,t){const n=Ut(t),i=function(){const e=Ut(s),t=new Map;for(const[n,i]of e)t.set(n,Jt("set",[i]));return t}();let o=e.pages.length;for(const t of Et)t.forEach((({name:t,shortName:r,set:s},a)=>{Xt(Kt(e,t),0===a);const l=gi(e,n.get(g[s]),i.get(g[s]),o);if(o++,l.length>0){l.sort(vi);const{nbPages:t,positions:n}=Jt("lines",[l]);for(let n=0;n<t;n++)Kt(e,`Extra ${r}`);for(const[t,{page:i,rows:r,cols:s}]of n.entries())sn(e,t,o+i,r[0],s[0]);o+=t}}))}function wi(e){var t;const n=qt(e),i=new Map;for(const[e,o]of n)i.set(e,Jt(null!==(t=e.layout)&&void 0!==t?t:"tier-lines",o));return i}function yi(e,t){var n,i;const o=qe(e),s=qe(t);return(null!==(n=t.quality)&&void 0!==n?n:0)-(null!==(i=e.quality)&&void 0!==i?i:0)||s.qlevel-o.qlevel||(t.unique?r[t.unique].qlevel:0)-(e.unique?r[e.unique].qlevel:0)}function _i(e,t){const n=It(t,!1),i=wi(!1),o=wi(!0);let r=e.pages.length;for(const t of $e)t.forEach(((t,s)=>{var a,l,c;const{name:d,shortName:u}=t,h=i.get(t),f=o.get(t);if(!h)throw new Error(`No template for ${d}`);for(let t=0;t<h.nbPages;t++){const n=Kt(e,d);0===t&&Xt(n,0===s)}for(let t=0;t<(null!==(a=null==f?void 0:f.nbPages)&&void 0!==a?a:0);t++)Kt(e,`Eth ${u}`);const p=null===(l=n.get(t))||void 0===l?void 0:l[0];if(!p)return void(r+=h.nbPages+(null!==(c=null==f?void 0:f.nbPages)&&void 0!==c?c:0));null==p||p.sort(((e,t)=>Number(e.ethereal)-Number(t.ethereal)));let m=gi(e,p,h,r);if(r+=h.nbPages,f){const t=m.filter((e=>!e.ethereal||!At(e)));t.push(...gi(e,m.filter((e=>e.ethereal&&At(e))),f,r)),m=t,r+=f.nbPages}if(m.length>0){m.sort(yi);const t=m.reduce(((e,t)=>{var n,i;let o=e.length-1;return(null===(i=null===(n=e[o])||void 0===n?void 0:n[0])||void 0===i?void 0:i.quality)!==t.quality&&(o=e.push([])-1),e[o].push(t),e}),[]),{nbPages:n,positions:i}=Jt("lines",t);for(let t=0;t<n;t++)Kt(e,`Extra ${u}`);for(const[t,{page:n,rows:o,cols:s}]of i.entries())sn(e,t,r+n,o[0],s[0]);r+=n}}))}function ki(e){let t=e.length;for(const n of e)n.filledSockets&&(t+=n.filledSockets.length);return t}function xi(e,t=[],n=0,i=0){const o=ki(wt(e))+ki(t),r=function(e,t,n=e.pages.length){const i=e.pages.splice(t,n-t),o=[];for(const{items:e}of i)o.push(...e);return o}(e,n);r.push(...t);for(let t=0;t<i;t++)Kt(e,"Misc");const s=function(e){const t=new Map(ni.map((e=>[e,[]])));for(const n of e)t.get(ii(n)).push(n);return t}(r);for(const t of ni){const n=s.get(t);if(n)switch(t){case"unknown":oi(e,n);break;case"rejuvs":si(e,n);break;case"respecs":ln(e,n);break;case"ubers":dn(e,n);break;case"gems":ui(e,n);break;case"runes":hi(e,n);break;case"runewords":mi(e,n);break;case"sets":bi(e,n);break;case"uniques":_i(e,n);break;default:throw new Error("Unknown section sectionId")}}if(ki(wt(e))!==o)throw new Error("Lost items in the process, cancelling")}function Si({selected:e,onChange:t,onlyStashes:n}){const{owners:i,hasPlugY:o}=ge(xt),[r]=ue((()=>({filename:"SharedStash.d2x",lastModified:Date.now(),version:96,personal:!1,nonPlugY:!0,gold:0,pageFlags:!0,pages:[]}))),s=pe((()=>i.some((e=>at(e)&&e.nonPlugY))),[i]);let a=i;return n&&(a=i.filter(at)),X("ul",Object.assign({class:"owner-selector"},{children:[a.map((n=>X("li",{children:X("label",{children:[X("input",{type:"radio",name:"target",checked:e===n,onChange:()=>t(n)},void 0)," ",X(En,{owner:n},void 0)]},void 0)},void 0))),!o&&!s&&X("li",{children:X("label",{children:[X("input",{type:"radio",name:"target",checked:e===r,onChange:()=>t(r)},void 0)," ","Create a new"," ",X("span",Object.assign({class:"magic"},{children:"Offline stash"}),void 0)," for me"]},void 0)},void 0)]}),void 0)}function Oi(e,t,n){const{height:i,width:o}=qe(e);return e.row+i>t||e.column+o>n}function ji(e,t,n,i){let o=0,r=0;for(;r<n&&o<i;){const s={...e,row:r,column:o};if(!Oi(s,n,i)&&!t.some((e=>en(s,e))))return[o,r];r++,r>=n&&(r=0,o++)}}Z(".owner-selector{list-style:none;padding:0}");function Ii(e,t,n){e.owner.version!==t.version&&(t.version>=97?nn(e):on(e)),e.owner=t,e.location=0,e.equippedInSlot=0,e.stored=n;const i=t.version>=97?-23:0;e.raw=e.raw.slice(0,58+i)+je(e.location,3)+je(e.equippedInSlot,4)+e.raw.slice(65+i,73+i)+je(e.stored,3)+e.raw.slice(76+i),e.corpse=!1,e.mercenary=!1}function Ai(e,t,n=5,i){if(st(t)){const n=t.pages[null!=i?i:0];let o=14,r=17;at(t)||(o=10,r=10);const s=ji(e,n.items,o,r);if(!s)return!1;rn(e,s),n.items.push(e),e.page=i}else{const i=t.items.filter((e=>e.stored===n)),{height:o,width:r}=function(e,t){switch(e){case 1:return{height:4,width:10};case 4:return{height:4,width:3};case 5:return t.version<=96?{height:8,width:6}:{height:10,width:10};default:throw new Error(`No dimensions for storage type ${e}`)}}(n,t),s=ji(e,i,o,r);if(!s)return!1;rn(e,s),t.items.push(e),delete e.page}return function(e){if(e.owner)if(st(e.owner))for(const t of e.owner.pages){const n=t.items.indexOf(e);if(n>=0){t.items.splice(n,1);break}}else{const t=e.owner.items.indexOf(e);t>=0&&e.owner.items.splice(t,1)}}(e),Ii(e,t,n),!0}function qi(){const{lastActivePlugyStashPage:e}=ge(xt),{updateAllFiles:t,rollback:n}=function(){const{owners:e,setCollection:t,setSingleFile:n}=ge(xt);return{updateAllFiles:me((async function(n){const i=[...e];n&&!i.includes(n)&&i.push(n);const o=i.map((e=>ft(e)));await vt(o),await ti(o),t(i)}),[e,t]),updateSingleFile:me((async function(e){const t=ft(e);await gt(t),ei(t,t.name),n(e)}),[n]),rollback:me((()=>bt().then(t)),[t])}}(),{selectedItems:i}=ge(_t),[o,r]=ue(),[s,a]=ue(),[l,c]=ue(),[d,u]=ue(),[h,f]=ue(!1),[p,m]=ue(0),g=pe((()=>Array.from(i)),[i]),v=me((async()=>{if(o)if(st(o)||s){c(void 0);try{!function(e,t,n=5){if(at(e)){let n=e.pages.length;Kt(e,"Transferred");for(const i of t)Ai(i,e,5,n)||(Kt(e,"Transferred"),n++,Ai(i,e,5,n))}else if(lt(e)){for(const i of t)if(!Ai(i,e,n))throw new Error("Not enough space to transfer all the selected items.")}else e:for(const n of t){let t=0;for(;t<e.pages.length;){if(Ai(n,e,5,t))continue e;t++}throw new Error("Not enough space to transfer all the selected items.")}}(o,g,s),at(o)&&(h||o.nonPlugY)&&xi(o,[],p),e&&function(e){var t,n;for(const[i,[o,r]]of e.entries())i.items=i.items.filter((({stored:e})=>5!==e)),i.items.push(...null!==(n=null===(t=o.pages[r])||void 0===t?void 0:t.items)&&void 0!==n?n:[])}(e),await t(o),u(`${g.length} items transferred!`)}catch(e){if(!(e instanceof Error))throw e;c(e.message),await n(),r(void 0)}}else c("Please select where you want to store the items on your character.");else c("Please select where you want to transfer the items.")}),[g,p,o,s,t,n,h,e]);if(0===g.length&&!l&&!d)return X("p",{children:["You have not selected any items yet. Go through your"," ",X("a",Object.assign({href:"#collection"},{children:"Collection"}),void 0)," or"," ",X("a",Object.assign({href:"#characters"},{children:"Characters"}),void 0)," and select the items you want to transfer."]},void 0);let b;return o&&lt(o)&&(b=[1,4],(null==e?void 0:e.has(o))||b.push(5)),X("div",Object.assign({id:"transfer-items"},{children:[X("p",{children:["You have currently selected ",X("span",Object.assign({class:"magic"},{children:g.length}),void 0)," ","items (full list below)."]},void 0),X("p",{children:"Select where you want to transfer them:"},void 0),X("div",Object.assign({class:"selectors"},{children:[X(Si,{selected:o,onChange:r},void 0),o&&(lt(o)||at(o)&&!o.nonPlugY)&&X("div",Object.assign({class:"arrow"},{children:"→"}),void 0),b&&X("ul",Object.assign({id:"storage-selector"},{children:b.map((e=>X("li",{children:X("label",{children:[X("input",{type:"radio",name:"storage",checked:s===e,onChange:()=>a(e)},void 0)," ",1===e?"Inventory":4===e?"Cube":"Stash"]},void 0)},void 0)))}),void 0),o&&at(o)&&!o.nonPlugY&&X("ul",Object.assign({id:"organize-selector"},{children:[X("li",{children:X("label",{children:[X("input",{type:"radio",name:"organize",checked:!h,onChange:()=>f(!1)},void 0)," ","Just add the items at the end of ",o.personal?"":"my"," ",X(En,{owner:o},void 0),"."]},void 0)},void 0),X("li",{children:[X("label",{children:[X("input",{type:"radio",name:"organize",checked:h,onChange:()=>f(!0)},void 0)," ","Organize ",o.personal?"":"my"," ",X(En,{owner:o},void 0)," for me"]},void 0),", except the first"," ",X("input",{type:"number",min:0,max:99,value:p,onChange:(w=e=>m(e),function(e){w(Number(e.target.value))})},void 0)," ","pages."]},void 0)]}),void 0)]}),void 0),X("p",{children:[X("button",Object.assign({class:"button",onClick:v},{children:"Transfer my items"}),void 0),X("span",Object.assign({class:"error danger"},{children:l}),void 0),X("span",Object.assign({class:"success"},{children:d}),void 0)]},void 0),X("h4",{children:"Selected items"},void 0),X(An,{items:g,selectable:!1,pageSize:10},void 0)]}),void 0);var w}function Ci({href:e,children:t}){return X("a",Object.assign({href:e,target:"_blank"},{children:[t," ",X("svg",Object.assign({class:"external-link-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},{children:[X("title",{children:"(opens in new tab)"},void 0),X("path",{fill:"currentColor",d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"},void 0)]}),void 0)]}),void 0)}Z(".external-link-icon{display:inline-block;height:.6em}");Z('.faq-question .button{border:none;color:#c7b377;font-size:18px;font-size:1.2em;padding:.5em .4em}.faq-question .button:before{content:"▸";display:inline-block;margin-right:.5em;transition:transform .4s}.faq-question.expanded .button:before{transform:rotate(90deg)}.faq-answer{border-left:1px solid #c7b377;height:0;margin-left:.75em;overflow:hidden;padding-left:1em}.faq-answer.expanded{height:auto;padding-bottom:.5em}.faq-answer>:first-child{margin-top:0}.faq-answer>:last-child{margin-bottom:0}');function Ei({question:e,startExpanded:t,children:n}){const[i]=ue((()=>"faq-0")),[o,r]=ue(t),s=fe(null),a=me((()=>{r((e=>{var t;return null===(t=s.current)||void 0===t||t.animate([{height:"0px"},{height:`${s.current.scrollHeight}px`}],{duration:400,easing:"ease-in-out",direction:e?"reverse":"normal"}),!e}))}),[]);return X(C,{children:[X("dt",Object.assign({class:"faq-question "+(o?"expanded":"")},{children:X("button",Object.assign({class:"button","aria-expanded":o,"aria-controls":i,onClick:a},{children:e}),void 0)}),void 0),X("dd",Object.assign({ref:s,class:"faq-answer accessible-font "+(o?"expanded":""),id:i},{children:n}),void 0)]},void 0)}function Mi(){return X("dl",Object.assign({id:"faq"},{children:[X(Ei,Object.assign({question:"I'm new here, what's this website?",startExpanded:!0},{children:[X("p",{children:["This tool is a collection manager for all of your single-player items in Diablo 2. You ",X("a",Object.assign({href:"#saves"},{children:"select your save folder"}),void 0),", the tool reads every single character file and stash in it, turning it into an ",X("a",Object.assign({href:"#collection"},{children:"easily searchable collection"}),void 0),'. Each item is evaluated with a perfection score, so you can quickly identify your 35% Spirit without inspecting all of them. When searching for an item, the tool gives a precise location to help you find it: "Worn by Hammerdin\'s Mercenary", or "In Fishymancer\'s Cube".']},void 0),X("p",{children:["You can also use this website as a replacement for GoMule. It allow you to"," ",X("a",Object.assign({href:"#transfer"},{children:"transfer items from one character to another"}),void 0),", either in bulk or a few at a time, and gives you the updated save files to download. It can also create an off-game stash to store as many items as you need if you do not have enough mules."]},void 0),X("p",{children:["If you are more of a PlugY fan than GoMule, this tool is fully PlugY-compatible. If your save folder contains PlugY stashes, these are fully parsed too. And it offers a feature to"," ",X("a",Object.assign({href:"#organize"},{children:"fully sort and organize"}),void 0)," your PlugY stash in one click, no matter how many items you hoarded."]},void 0),X("p",{children:["Finally, this website also serves as a"," ",X("a",Object.assign({href:"#grail-tracker"},{children:"Grail tracker"}),void 0)," that you never have to manually update. Simply refresh your save files and you will immediately see your progress."]},void 0)]}),void 0),X(Ei,Object.assign({question:"Is this compatible with Diablo 2 Resurrected?"},{children:"Yes! You can seamlessly transfer items between legacy D2 and D2 Resurrected characters, for instance using your legacy PlugY stash as an offline D2R stash."}),void 0),X(Ei,Object.assign({question:'When you say "easily searchable", what can I search for?'},{children:[X("p",{children:"When searching in your collection, you can search for:"},void 0),X("ul",{children:[X("li",{children:'Item names: "Tal Rasha"'},void 0),X("li",{children:'Modifiers: "All res"'},void 0),X("li",{children:'Number of sockets: "3 sockets"'},void 0),X("li",{children:'Items in sockets: "Rainbow Facet"'},void 0)]},void 0),X("p",{children:'When searching on a character, you can also search for a specific location, like "Equipped" or "Mercenary". When searching in a stash, you can search for a specific page, like "Shared page 42".'},void 0),X("p",{children:'Finally, like most search tools, using double-quotes " will force a perfect match. You can combine this to create advanced searches like:'},void 0),X("blockquote",{children:'"4 sockets" "15% enhanced"'},void 0),X("p",{children:"To help you find your items in-game, the search results indicate very precisely where each item is:"},void 0),X("p",{children:X("img",{src:"examples/item-finder.png",style:"max-width",alt:"Three Andariel's Visages, one worn by a mercenary, one in a cube, and one on page 48 of the shared stash"},void 0)},void 0)]}),void 0),X(Ei,Object.assign({question:'What do you mean by "perfection score"?'},{children:[X("p",{children:"Many unique and set items have can roll properties and modifiers within a range. For instance, Tal Rasha's Lidless Eye can drop +1 or +2 to each elemental mastery. This is displayed using brackets next to each property that can vary:"},void 0),X("p",{children:X("img",{src:"examples/item-info.png",style:"max-width",alt:"Three Andariel's Visages, one worn by a mercenary, one in a cube, and one on page 48 of the shared stash"},void 0)},void 0),X("p",{children:'In this case, it dropped with +1 Cold Mastery, +2 Lightning Mastery and +2 Fire Mastery. As such, it has 2 perfect rolls out of 3, which makes it "66% perfect".'},void 0)]}),void 0),X(Ei,Object.assign({question:"Where am I uploading my save files?"},{children:["Nowhere! Your data is yours, this website does not send anything to the server. In fact, once the page has been loaded, the tool works fully offline if you want to. If you're not convinced, the entire source code for this project is"," ",X(Ci,Object.assign({href:"https://github.com/youdz/d2-stash-organizer"},{children:"open-source on GitHub"}),void 0),"."]}),void 0),X(Ei,Object.assign({question:"Is this compatible with PlugY?"},{children:["Not only is it fully compatible with PlugY stashes, it also lets you"," ",X("a",Object.assign({href:"#organize"},{children:"fully sort and organize"}),void 0)," them in one click. We all know how long we've been putting off cleaning our stash, well now we don't have to!"]}),void 0),X(Ei,Object.assign({question:"How will this sort my very large PlugY stash?"},{children:[X("p",{children:"That's a pretty long answer, but you asked for it. Not that you cannot configure the sort order, but you can tell the organizer to leave untouched any number of pages at the start of your stash, or tell it to add extra empty pages at the beginning."},void 0),X("ol",{children:[X("li",{children:"Rejuvenation potions"},void 0),X("li",{children:"Essences and tokens"},void 0),X("li",{children:"Organs and keys"},void 0),X("li",{children:"Gems: every gem type gets its own page(s), each page sorted by grade of gem (from chipped to perfect)"},void 0),X("li",{children:"Runes by rank, with an empty line between each rank for clarity"},void 0),X("li",{children:"Bases (white and grey items), ordered by:"},void 0),X("ol",{children:[X("li",{children:"Equipment type (same order as the equipment sections below)"},void 0),X("li",{children:["Within each equipment type, sorted by descending"," ",X(Ci,Object.assign({href:"http://classic.battle.net/diablo2exp/items/basics.shtml#qlevel"},{children:"qlevel"}),void 0)," ","(meaning Sacred Armor first and Quilted Armor last, for instance)"]},void 0),X("li",{children:"Within each qlevel, sorted by number of sockets (useful if you have 12 Crystal Swords)"},void 0)]},void 0),X("li",{children:"Runewords sorted by level requirement"},void 0),X("li",{children:"For each type of possibly unique item (rings, amulets, charms, jewels, armor, helms, gloves, ...):"},void 0),X("ol",{children:[X("li",{children:'One of each unique displayed in "grail mode", one page per tier (normal, exceptional, elite) if they don\'t fit on one page'},void 0),X("li",{children:'One of each eth unique displayed in "grail mode"'},void 0),X("li",{children:"Duplicate uniques sorted by descending qlevel"},void 0),X("li",{children:"Rares sorted by descending qlevel"},void 0),X("li",{children:"Magic items sorted by descending qlevel"},void 0)]},void 0),X("li",{children:"For each set:"},void 0),X("ol",{children:[X("li",{children:"A first pretty page with the set fully laid out"},void 0),X("li",{children:"Duplicate items of the same set, grouped by which piece it is, just laid out in line"},void 0)]},void 0)]},void 0),X("p",{children:"Here are some example pages after organization:"},void 0),X("p",{children:[X("img",{src:"examples/armor.png",alt:"Unique normal armors organized by level"},void 0),X("img",{src:"examples/runes.png",alt:"Low-level runes layed out line by line"},void 0),X("img",{src:"examples/cathan.png",alt:"Cathan's Traps set nicely layed out on a single page"},void 0),X("img",{src:"examples/sigon.png",alt:"Sigon's Complete Steel set nicely layed out on a single page"},void 0)]},void 0)]}),void 0),X(Ei,Object.assign({question:"Can this be used to edit, hack or mod items?"},{children:"The tool does not have the capability to modify item stats, skills or properties. The only fields that can be modified at the moment are the ones related to the item's location."}),void 0),X(Ei,Object.assign({question:"How do I transfer many items at once?"},{children:[X("p",{children:["Go to ",X("a",Object.assign({href:"#collection"},{children:"your collection"}),void 0)," or a specific"," ",X("a",Object.assign({href:"#characters"},{children:"character or stash page"}),void 0),'. Search for the items you want (or do not search if you want to transfer all items), and click the "Select all items" button. This will select all items returned by the search. After that, simply go to the'," ",X("a",Object.assign({href:"#characters"},{children:"transfer page"}),void 0)," and select where you want to send them."]},void 0),X("p",{children:"There is no limit to how many items you can transfer at once, provided you have enough room at the destination. For instance, you can transfer thousands of items in one click from a personal PlugY stash to the shared stash:"},void 0),X("p",{children:X("img",{src:"examples/bulk-transfer.png",alt:"Unique normal armors organized by level"},void 0)},void 0)]}),void 0),X(Ei,Object.assign({question:"How do I transfer all items in a single stash page?"},{children:["Go to ",X("a",Object.assign({href:"#characters"},{children:"that stash"}),void 0),', and search for the exact page name (for instance, "Shared Page 42"). Click the "Select all items" button, the ',X("a",Object.assign({href:"#characters"},{children:"transfer page"}),void 0)," will now transfer exactly the items in that page."]}),void 0),X(Ei,Object.assign({question:"How do I get help or report a bug?"},{children:[X("p",{children:["First, check if someone else already"," ",X(Ci,Object.assign({href:"https://github.com/youdz/d2-stash-organizer/issues"},{children:"asked that question or reported the bug on GitHub"}),void 0),". If you don't find your answer, go ahead and"," ",X(Ci,Object.assign({href:"https://github.com/youdz/d2-stash-organizer/issues/new"},{children:"submit an issue"}),void 0)," ","for it."]},void 0),X("p",{children:["If you do not have a GitHub account and do not want to create one, which is completely understandable, you can reach out to me on"," ",X(Ci,Object.assign({href:"https://twitter.com/EudesPV"},{children:"Twitter"}),void 0)," ","or"," ",X(Ci,Object.assign({href:"https://www.reddit.com/user/EudesPV/"},{children:"Reddit"}),void 0)]},void 0)]}),void 0)]}),void 0)}Z(".radiolist{list-style:none;padding:0}");const $i=Q({accessibleFont:!1,toggleAccessibleFont:()=>{}});function Ui({children:e}){const[t,n]=ue((()=>"true"===localStorage.getItem("accessibleFont"))),i=me((()=>{n((e=>(localStorage.setItem("accessibleFont",`${!e}`),!e)))}),[]),o=pe((()=>({accessibleFont:t,toggleAccessibleFont:i})),[t,i]);return X($i.Provider,Object.assign({value:o},{children:e}),void 0)}function Pi(){const{accessibleFont:e,toggleAccessibleFont:t}=ge($i);return X(C,{children:[X("p",{children:X("label",{children:[X("input",{type:"checkbox",name:"font",checked:!e,onChange:t},void 0)," ","Use Diablo font"]},void 0)},void 0),X("p",Object.assign({class:"sidenote"},{children:"More settings to come..."}),void 0)]},void 0)}function Ni({hash:e,isHome:t,children:n}){const i=location.hash===e||t&&""===location.hash;return X("a",Object.assign({class:i?"nav-link active":"nav-link",href:e},{children:n}),void 0)}function Ti(){const[e,t]=ue(location.hash),{selectedItems:n}=ge(_t);he((()=>{const e=()=>t(location.hash);return window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)}),[]);const i=pe((()=>{switch(e){case"#saves":return X($n,{},void 0);case"#collection":return X(qn,{},void 0);case"#characters":return X(On,{},void 0);case"#transfer":return X(qi,{},void 0);case"#grail-tracker":return X(Rt,{},void 0);case"#settings":return X(Pi,{},void 0);default:return X(Mi,{},void 0)}}),[e]);return X(C,{children:[X("nav",Object.assign({id:"navigation","data-nosnippet":!0},{children:[X(Ni,Object.assign({hash:"#saves"},{children:"Save files"}),void 0),X(Ni,Object.assign({hash:"#collection"},{children:"Collection"}),void 0),X(Ni,Object.assign({hash:"#characters"},{children:"Characters"}),void 0),X(Ni,Object.assign({hash:"#transfer"},{children:["Transfer ",n.size?n.size:""," items"]}),void 0),X(Ni,Object.assign({hash:"#grail-tracker"},{children:"Grail tracker"}),void 0),X(Ni,Object.assign({hash:"#settings"},{children:"Settings"}),void 0)]}),void 0),X("main",{children:i},void 0)]},void 0)}function Li(){return X("a",Object.assign({id:"help-link",href:"#help","aria-label":"Help"},{children:"?"}),void 0)}Z("#help-link{border:2px solid;border-color:initial;border-radius:50%;box-sizing:border-box;display:block;float:right;font-size:26px;height:32px;line-height:28px;margin-right:18px;padding-left:6px;padding-top:2px;width:32px}"),function(e,t,n){var i,o,r;b.__&&b.__(e,t),o=(i="function"==typeof n)?null:n&&n.__k||t.__k,r=[],H(t,e=(!i&&n||t).__k=function(e,t,n){var i,o,r,s={};for(r in t)"key"==r?i=t[r]:"ref"==r?o=t[r]:s[r]=t[r];if(arguments.length>2&&(s.children=arguments.length>3?v.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===s[r]&&(s[r]=e.defaultProps[r]);return q(e,s,i,o,null)}(C,null,[e]),o||S,S,void 0!==t.ownerSVGElement,!i&&n?[n]:o?null:t.firstChild?v.call(t.childNodes):null,r,!i&&n?n:o?o.__e:t.firstChild,i),R(r,e)}(X((function({children:e}){return X(Ui,{children:X(kt,{children:X(Ot,{children:e},void 0)},void 0)},void 0)}),{children:X((function(){const{accessibleFont:e}=ge($i);return X("div",Object.assign({id:"app",class:e?"accessible-font":""},{children:[X(K,{},void 0),X(Li,{},void 0),X("h1",{children:"Diablo 2 Reimagined Collection Manager"},void 0),X(Ti,{},void 0)]}),void 0)}),{},void 0)},void 0),document.body,document.getElementById("app"));
